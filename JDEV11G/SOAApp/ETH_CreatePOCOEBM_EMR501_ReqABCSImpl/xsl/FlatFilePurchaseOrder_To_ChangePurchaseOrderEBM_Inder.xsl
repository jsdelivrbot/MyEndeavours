<?xml version="1.0" encoding="UTF-8" ?>
<?oracle-xsl-mapper
  <!-- SPECIFICATION OF MAP SOURCES AND TARGETS, DO NOT MODIFY. -->
  <mapSources>
    <source type="XSD">
      <schema location="oramds:/apps/AIAMetaData/AIAComponents/ApplicationObjectLibrary/ETH/FlatFile/PO/V1/EMRFlatFile_ETH_PO.xsd"/>
      <rootElement name="PurchaseOrder" namespace="http://schema.emerson.com/ETH/FlatFile/V1"/>
    </source>
    <source type="XSD">
      <schema location="oramds:/apps/ETH3/CommonServices/commonSchemas/ETH_Header.xsd"/>
      <rootElement name="ETHHEADER" namespace="http://schema.emerson.com/ETH/Header"/>
      <param name="lvarXSLTParameter.ETH_HeaderMsg" />
    </source>
  </mapSources>
  <mapTargets>
    <target type="WSDL">
      <schema location="oramds:/apps/AIAMetaData/AIAComponents/EnterpriseBusinessServiceLibrary/Industry/Manufacturing/EBO/PurchaseOrder/Emerson/PurchaseOrderEmersonEBS.wsdl"/>
      <rootElement name="ChangePurchaseOrderEBM" namespace="http://xmlns.oracle.com/EnterpriseObjects/Manufacturing/EBO/PurchaseOrder/Emerson"/>
    </target>
  </mapTargets>
  <!-- GENERATED BY ORACLE XSL MAPPER 11.1.1.4.0(build 110106.1932.5682) AT [WED JUL 20 15:18:02 GMT+05:30 2011]. -->
?>
<xsl:stylesheet version="1.0"
                xmlns:svcdoc="http://xmlns.oracle.com/Services/Documentation/V1"
                xmlns:bpws="http://schemas.xmlsoap.org/ws/2003/03/business-process/"
                xmlns:xp20="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.Xpath20"
                xmlns:bpel="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
                xmlns:ethCustomSOA="http://www.oracle.com/XSL/Transform/java/com.emerson.eth3.customSOA.ETHCustomSOAExtension"
                xmlns:ethCustomXSLT="http://www.oracle.com/XSL/Transform/java/com.emerson.eth3.customXSLT.ETHCustomXSLTExtension"
                xmlns:ns3="http://www.openapplications.org/oagis/9/unqualifieddatatypes/1.1"
                xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                xmlns:ebs="http://xmlns.oracle.com/EnterpriseServices/Manufacturing/EBO/PurchaseOrder/Emerson"
                xmlns:bpm="http://xmlns.oracle.com/bpmn20/extensions"
                xmlns:ns6="http://www.openapplications.org/oagis/9/qualifieddatatypes/1.1"
                xmlns:ns7="http://www.openapplications.org/oagis/9/unitcode/66411:2001"
                xmlns:ebo="http://xmlns.oracle.com/EnterpriseObjects/Manufacturing/EBO/PurchaseOrder/Emerson"
                xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/"
                xmlns:ns8="http://xmlns.oracle.com/EnterpriseObjects/Core/Custom/EBO/PurchaseOrder/V1"
                xmlns:ns9="http://www.openapplications.org/oagis/9"
                xmlns:ns10="http://xmlns.oracle.com/EnterpriseObjects/Core/Custom/Common/V2"
                xmlns:ora="http://schemas.oracle.com/xpath/extension"
                xmlns:socket="http://www.oracle.com/XSL/Transform/java/oracle.tip.adapter.socket.ProtocolTranslator"
                xmlns:customEBMHeader="http://schemas.emerson.com/eth/customEBMHeader"
                xmlns:ns1="http://schemas.xmlsoap.org/ws/2003/03/addressing"
                xmlns:ns2="http://www.openapplications.org/oagis/9/currencycode/54217:2001"
                xmlns:mhdr="http://www.oracle.com/XSL/Transform/java/oracle.tip.mediator.service.common.functions.MediatorExtnFunction"
                xmlns:oraext="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.ExtFunc"
                xmlns:ns4="http://www.openapplications.org/oagis/9/codelists"
                xmlns:dvm="http://www.oracle.com/XSL/Transform/java/oracle.tip.dvm.LookupValue"
                xmlns:hwf="http://xmlns.oracle.com/bpel/workflow/xpath"
                xmlns:med="http://schemas.oracle.com/mediator/xpath"
                xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:ids="http://xmlns.oracle.com/bpel/services/IdentityService/xpath"
                xmlns:ns5="urn:oasis:names:tc:xacml:2.0:policy:schema:cd:04"
                xmlns:xdk="http://schemas.oracle.com/bpel/extension/xpath/function/xdk"
                xmlns:nxsd="http://xmlns.oracle.com/pcbpel/nxsd"
                xmlns:xref="http://www.oracle.com/XSL/Transform/java/oracle.tip.xref.xpath.XRefXPathFunctions"
                xmlns:xsd="http://www.w3.org/2001/XMLSchema"
                xmlns:ns0="http://schema.emerson.com/ETH/FlatFile/V1"
                xmlns:corecom="http://xmlns.oracle.com/EnterpriseObjects/Core/Common/V2"
                xmlns:eth="http://schema.emerson.com/ETH/Header"
                xmlns:ns11="urn:oasis:names:tc:xacml:2.0:context:schema:cd:04"
                xmlns:ns12="http://www.openapplications.org/oagis/9/languagecode/5639:1988"
                xmlns:ldap="http://schemas.oracle.com/xpath/extension/ldap"
                exclude-result-prefixes="xsi xsl nxsd xsd tns eth svcdoc customEBMHeader ns3 ebs ns6 ns7 ebo soap ns8 ns9 ns10 ns0 ns1 ns2 ns4 ns5 corecom ns11 ns12 bpws xp20 bpel ethCustomSOA ethCustomXSLT bpm ora socket mhdr oraext dvm hwf med ids xdk xref ldap">
  <xsl:param name="lvarXSLTParameter.ETH_HeaderMsg"/>
  <xsl:variable name="SenderID" select="$lvarXSLTParameter.ETH_HeaderMsg/eth:ETHHEADER/eth:SENDER_ID"/> 
  <xsl:variable name="JDBC_URL" select="$lvarXSLTParameter.ETH_HeaderMsg/eth:ETHHEADER/eth:HEADER_PROPERTY_SET/eth:HEADER_PROPERTY[@name='JDBC_URL']/@value"/>
  <xsl:variable name="JDBC_CONF_JNDI" select="$lvarXSLTParameter.ETH_HeaderMsg/eth:ETHHEADER/eth:HEADER_PROPERTY_SET/eth:HEADER_PROPERTY[@name='JDBC_CONF_JNDI']/@value"/>
  <xsl:variable name="PROCESS_NAME" select="$lvarXSLTParameter.ETH_HeaderMsg/eth:ETHHEADER/eth:HEADER_PROPERTY_SET/eth:HEADER_PROPERTY[@name='COMPOSITE_NAME']/@value"/>
  <xsl:variable name="PROCESS_INSTANCE" select="$lvarXSLTParameter.ETH_HeaderMsg/eth:ETHHEADER/eth:HEADER_PROPERTY_SET/eth:HEADER_PROPERTY[@name='COMPOSITE_INSTANCE_ID']/@value"/>
  <xsl:variable name="COMPONENT_NAME" select="$lvarXSLTParameter.ETH_HeaderMsg/eth:ETHHEADER/eth:HEADER_PROPERTY_SET/eth:HEADER_PROPERTY[@name='COMPONENT_NAME']/@value"/>
  <xsl:variable name="COMPONENT_INSTANCE_ID" select="$lvarXSLTParameter.ETH_HeaderMsg/eth:ETHHEADER/eth:HEADER_PROPERTY_SET/eth:HEADER_PROPERTY[@name='COMPONENT_INSTANCE_ID']/@value"/>
  <xsl:variable name="LOOKUP_UOM_TYPE" select="string('BASISOFUNITPRICE')"/>
  <xsl:variable name="LOOKUP_POHDR_STATUS_TYPE" select="string('POHEADERSTATUS')"/>
  <xsl:variable name="LOOKUP_POLINE_STATUS_TYPE" select="string('POLINESTATUS')"/>
  <xsl:variable name="DEFAULT_STATUS" select="string('OPEN')"/>
  <xsl:variable name="Default_N104" select="string('ZZ')"/>
  <xsl:variable name="Default_N403" select="string('999999')"/>
  <xsl:variable name="Default_SCH06_09" select="string('1900-01-01T00:00:00.0000+00:00')"/>
  <xsl:variable name="WRONG_DATE" select="string('00000000')"/>
  <xsl:key name="keyLine" match="/ns0:PurchaseOrder/ns0:Line" use="ns0:LN1PO101"/>
  <xsl:template match="/">
     <ebo:ChangePurchaseOrderEBM>
      
     <ebo:DataArea>
      
        <ebo:ChangePurchaseOrder>
          <!--<xsl:variable name="POCO_HDR_STATUS" select="ethCustomXSLT:formatValue(ethCustomXSLT:ethParameterLookup($JDBC_CONF_JNDI,$JDBC_URL,'false', $PROCESS_NAME, $PROCESS_INSTANCE, $LOOKUP_POHDR_STATUS_TYPE,normalize-space(/ns0:PurchaseOrder/ns0:Line[1]/ns0:HDBEG01), $DEFAULT_STATUS),2,10,0,$DEFAULT_STATUS,$DEFAULT_STATUS)"/>-->
          
          <!-- Ryan - if there is HEADER Status is CANCEL, dont map any Line -->
          <!--<xsl:if test="$POCO_HDR_STATUS != 'CANCEL'">-->
            <!--<xsl:for-each select="/ns0:PurchaseOrder/ns0:Line">-->
              <xsl:for-each select="/ns0:PurchaseOrder/ns0:Line[(ns0:LN1PO101!=following-sibling::ns0:Line/ns0:LN1PO101) or (position()=last())]">
                <xsl:value-of select="ns0:LN1PO101"/>
                <xsl:value-of select="ns0:LN1PO102"/>
              </xsl:for-each>
              <!--<xsl:for-each select="key('keyLine',ns0:LN1PO101)">
                Key Inside
              </xsl:for-each>-->

            <!--</xsl:for-each>-->
          <!--</xsl:if>-->
        </ebo:ChangePurchaseOrder>
      </ebo:DataArea>    
      
  </ebo:ChangePurchaseOrderEBM> 
  </xsl:template>
</xsl:stylesheet>
