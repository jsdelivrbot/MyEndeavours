<?xml version="1.0" encoding="UTF-8" ?>
<?oracle-xsl-mapper
  <!-- SPECIFICATION OF MAP SOURCES AND TARGETS, DO NOT MODIFY. -->
  <mapSources>
    <source type="WSDL">
      <schema location="../ETH_FL_RD_PO_EBM.wsdl"/>
      <rootElement name="CreatePurchaseOrderEBM" namespace="http://xmlns.oracle.com/EnterpriseObjects/Manufacturing/EBO/PurchaseOrder/Emerson"/>
    </source>
  </mapSources>
  <mapTargets>
    <target type="WSDL">
      <schema location="../ETH_FL_WR_PO_EDI.wsdl"/>
      <rootElement name="Transaction-850" namespace="http://schema.emerson.com/ETH/EDI/850/V5020"/>
    </target>
  </mapTargets>
  <!-- GENERATED BY ORACLE XSL MAPPER 11.1.1.4.0(build 110106.1932.5682) AT [FRI MAY 13 22:33:37 GMT+05:30 2011]. -->
?>
<xsl:stylesheet version="1.0"
                xmlns:aia="http://www.oracle.com/XSL/Transform/java/oracle.apps.aia.core.xpath.AIAFunctions"
                xmlns:bpws="http://schemas.xmlsoap.org/ws/2003/03/business-process/"
                xmlns:xp20="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.Xpath20"
                xmlns:bpel="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
                xmlns:ns3="http://www.openapplications.org/oagis/9/unqualifieddatatypes/1.1"
                xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                xmlns:pc="http://xmlns.oracle.com/pcbpel/"
                xmlns:bpm="http://xmlns.oracle.com/bpmn20/extensions"
                xmlns:ns6="http://www.openapplications.org/oagis/9/qualifieddatatypes/1.1"
                xmlns:ns7="http://www.openapplications.org/oagis/9/unitcode/66411:2001"
                xmlns:plt="http://schemas.xmlsoap.org/ws/2003/05/partner-link/"
                xmlns:imp1="http://xmlns.oracle.com/EnterpriseObjects/Manufacturing/EBO/PurchaseOrder/Emerson"
                xmlns:ns11="http://xmlns.oracle.com/EnterpriseObjects/Core/Custom/Common/V2"
                xmlns:ns9="http://www.openapplications.org/oagis/9"
                xmlns:ns8="http://xmlns.oracle.com/EnterpriseObjects/Core/Custom/EBO/PurchaseOrder/V1"
                xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/"
                xmlns:ora="http://schemas.oracle.com/xpath/extension"
                xmlns:socket="http://www.oracle.com/XSL/Transform/java/oracle.tip.adapter.socket.ProtocolTranslator"
                xmlns:tns="http://xmlns.oracle.com/pcbpel/adapter/file/Sarah_Mappings/ETH_Sarah_ConnectorService/ETH_FL_RD_PO_EBM"
                xmlns:ns0="http://www.openapplications.org/oagis/9/IANAMIMEMediaTypes:2003"
                xmlns:ns2="http://www.openapplications.org/oagis/9/currencycode/54217:2001"
                xmlns:ns1="http://schemas.xmlsoap.org/ws/2003/03/addressing"
                xmlns:mhdr="http://www.oracle.com/XSL/Transform/java/oracle.tip.mediator.service.common.functions.MediatorExtnFunction"
                xmlns:oraext="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.ExtFunc"
                xmlns:ns14="http://xmlns.oracle.com/pcbpel/adapter/file/Sarah_Mappings/ETH_Sarah_ConnectorService/ETH_FL_WR_PO_EDI"
                xmlns:ethCustomXSLT="http://www.oracle.com/XSL/Transform/java/com.emerson.eth3.customXSLT.ETHCustomXSLTExtension"
                xmlns:ns4="http://www.openapplications.org/oagis/9/codelists"
                xmlns:dvm="http://www.oracle.com/XSL/Transform/java/oracle.tip.dvm.LookupValue"
                xmlns:hwf="http://xmlns.oracle.com/bpel/workflow/xpath"
                xmlns:ns16="http://schema.emerson.com/ETH/EDI/850/V5020"
                xmlns:jca="http://xmlns.oracle.com/pcbpel/wsdl/jca/"
                xmlns:med="http://schemas.oracle.com/mediator/xpath"
                xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:ids="http://xmlns.oracle.com/bpel/services/IdentityService/xpath"
                xmlns:ns5="urn:oasis:names:tc:xacml:2.0:policy:schema:cd:04"
                xmlns:xdk="http://schemas.oracle.com/bpel/extension/xpath/function/xdk"
                xmlns:xref="http://www.oracle.com/XSL/Transform/java/oracle.tip.xref.xpath.XRefXPathFunctions"
                xmlns:xsd="http://www.w3.org/2001/XMLSchema"
                xmlns:ns10="http://xmlns.oracle.com/EnterpriseObjects/Core/Common/V2"
                xmlns:bpmn="http://schemas.oracle.com/bpm/xpath"
                xmlns:ns12="urn:oasis:names:tc:xacml:2.0:context:schema:cd:04"
                xmlns:ns13="http://www.openapplications.org/oagis/9/languagecode/5639:1988"
                xmlns:ldap="http://schemas.oracle.com/xpath/extension/ldap"
                exclude-result-prefixes="xsi xsl ns3 pc ns6 ns7 plt imp1 ns11 ns9 ns8 wsdl tns ns0 ns2 ns1 ns4 jca ns5 xsd ns10 ns12 ns13 ns14 ns16 aia bpws xp20 bpel bpm ora socket mhdr oraext ethCustomXSLT dvm hwf med ids xdk xref bpmn ldap">
  <xsl:template match="/">
    <ns16:Transaction-850>
      <ns16:Segment-ISA>
        <ns16:Element-I14>
          <xsl:value-of select='string("P")'/>
        </ns16:Element-I14>
      </ns16:Segment-ISA>
      <ns16:Segment-GS>
        <ns16:Element-479>
          <xsl:value-of select='string("PO")'/>
        </ns16:Element-479>
      </ns16:Segment-GS>
      <ns16:Segment-ST>
        <ns16:Element-143>
          <xsl:value-of select='string("850")'/>
        </ns16:Element-143>
      </ns16:Segment-ST>
      <ns16:Segment-BEG>
        <xsl:choose>
          <xsl:when test='/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:DocumentID/ns9:VariationID = "STANDARD"'>
            <ns16:Element-92>
              <xsl:text disable-output-escaping="no">SA</xsl:text>
            </ns16:Element-92>
          </xsl:when>
          <xsl:when test='/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:DocumentID/ns9:VariationID = "BLANKET"'>
            <ns16:Element-92>
              <xsl:text disable-output-escaping="no">BK</xsl:text>
            </ns16:Element-92>
          </xsl:when>
          <xsl:otherwise>
            <ns16:Element-92>
              <xsl:text disable-output-escaping="no">ZZ</xsl:text>
            </ns16:Element-92>
          </xsl:otherwise>
        </xsl:choose>
        <ns16:Element-324>
          <xsl:value-of select="/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:DocumentID/ns9:ID"/>
        </ns16:Element-324>
        <xsl:if test='/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:ReleaseNumber != ""'>
          <ns16:Element-328>
            <xsl:value-of select='ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:ReleaseNumber,1.0,30.0,0.0,"Z","ERROR")'/>
          </ns16:Element-328>
        </xsl:if>
        <ns16:Element-587>
          <xsl:value-of select='string("AC")'/>
        </ns16:Element-587>
      </ns16:Segment-BEG>
      <ns16:Segment-CUR>
        <ns16:Element-98>
          <xsl:value-of select='string("BY")'/>
        </ns16:Element-98>
        <ns16:Element-100>
          <xsl:value-of select='ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:ExtendedAmount/@currencyID,3.0,3.0,1.0,"ZZZ","ZZZ")'/>
        </ns16:Element-100>
        <ns16:Element-280>
          <xsl:value-of select='ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:UserArea/ns9:CustomPurchaseOrderHeaderUserArea/ns9:EXCHRATE,4.0,10.0,0.0,"ZZZZ","ZZZZ")'/>
        </ns16:Element-280>
        <xsl:if test="/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:UserArea/ns9:CustomPurchaseOrderHeaderUserArea/ns9:ExchangeRateDate">
          <ns16:Element-374>
            <xsl:value-of select='string("AAY")'/>
          </ns16:Element-374>
        </xsl:if>
      </ns16:Segment-CUR>
      <ns16:Segment-REF>
        <ns16:Element-128>
          <xsl:value-of select='string("S3")'/>
        </ns16:Element-128>
        <ns16:Element-127>
          <xsl:value-of select='string("EMR850V1.0")'/>
        </ns16:Element-127>
      </ns16:Segment-REF>
      <xsl:if test="/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:DocumentID/ns9:RevisionID != ''">
        <ns16:Segment-REF>
          <ns16:Element-128>
            <xsl:value-of select="string('PP')"/>
          </ns16:Element-128>
          <ns16:Element-352>
            <xsl:value-of select="/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:DocumentID/ns9:RevisionID"/>
          </ns16:Element-352>
        </ns16:Segment-REF>
      </xsl:if>
      <ns16:Segment-FOB>
        <xsl:choose>
          <xsl:when test='xp20:lower-case(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:TransportationTerm/ns9:FreightTermCode) = "prepaid"'>
            <ns16:Element-146>
              <xsl:value-of select='string("PP")'/>
            </ns16:Element-146>
          </xsl:when>
          <xsl:when test='xp20:lower-case(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:TransportationTerm/ns9:FreightTermCode) = "collect"'>
            <ns16:Element-146>
              <xsl:value-of select='string("CC")'/>
            </ns16:Element-146>
          </xsl:when>
          <xsl:when test='xp20:lower-case(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:TransportationTerm/ns9:FreightTermCode) = "prepaid&amp;add"'>
            <ns16:Element-146>
              <xsl:value-of select='string("PC")'/>
            </ns16:Element-146>
          </xsl:when>
          <xsl:when test='xp20:lower-case(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:TransportationTerm/ns9:FreightTermCode) = "thirdparty"'>
            <ns16:Element-146>
              <xsl:value-of select='string("TP")'/>
            </ns16:Element-146>
          </xsl:when>
          <xsl:when test='xp20:lower-case(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:TransportationTerm/ns9:FreightTermCode) = "pickup"'>
            <ns16:Element-146>
              <xsl:value-of select='string("PB")'/>
            </ns16:Element-146>
          </xsl:when>
          <xsl:otherwise>
            <ns16:Element-146>
              <xsl:value-of select='string("DF")'/>
            </ns16:Element-146>
          </xsl:otherwise>
        </xsl:choose>
        <xsl:choose>
        <xsl:when test="xp20:lower-case(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:TransportationTerm/ns9:IncotermsCode) = 'fob origin'">
        <ns16:Element-334><xsl:value-of select="string('1')"/></ns16:Element-334>
        <ns16:Element-335><xsl:value-of select="string('FOB')"/></ns16:Element-335>
        <ns16:Element-309_1><xsl:value-of select="string('OA')"/></ns16:Element-309_1>
        <ns16:Element-352_2><xsl:value-of select="concat(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:TransportationTerm/ns9:FreightTermCode,/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:TransportationTerm/ns9:IncotermsCode)"/></ns16:Element-352_2>
        </xsl:when>
        <xsl:when test="xp20:lower-case(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:TransportationTerm/ns9:IncotermsCode) = 'fob destination'">
        <ns16:Element-334><xsl:value-of select="string('1')"/></ns16:Element-334>
        <ns16:Element-335><xsl:value-of select="string('FOB')"/></ns16:Element-335>
        <ns16:Element-309_1><xsl:value-of select="string('DE')"/></ns16:Element-309_1>
        <ns16:Element-352_2><xsl:value-of select="concat(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:TransportationTerm/ns9:FreightTermCode,/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:TransportationTerm/ns9:IncotermsCode)"/></ns16:Element-352_2>
        </xsl:when>
        <xsl:when test="starts-with(xp20:lower-case(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:TransportationTerm/ns9:IncotermsCode),'inco')">
        <ns16:Element-334>
          <xsl:value-of select='string("1")'/>
        </ns16:Element-334>
        <ns16:Element-335>
          <xsl:value-of select="ethCustomXSLT:split(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:TransportationTerm/ns9:IncotermsCode,':',2,'ERROR')"/>
        </ns16:Element-335>
        <ns16:Element-352_1>
          <xsl:value-of select="ethCustomXSLT:split(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:TransportationTerm/ns9:IncotermsCode,':',3,'ERROR')"/>
        </ns16:Element-352_1>
        <ns16:Element-352_2>
          <xsl:value-of select="concat(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:TransportationTerm/ns9:FreightTermCode,/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:TransportationTerm/ns9:IncotermsCode)"/>
        </ns16:Element-352_2>
        </xsl:when>
        <xsl:when test="starts-with(xp20:lower-case(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:TransportationTerm/ns9:IncotermsCode),'emr')">
        <ns16:Element-334><xsl:value-of select="string('1')"/></ns16:Element-334>
        <ns16:Element-335><xsl:value-of select="string('ZZZ')"/></ns16:Element-335>
        <ns16:Element-352_1><xsl:value-of select="ethCustomXSLT:split(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:TransportationTerm/ns9:IncotermsCode,':',2,'ERROR')"/></ns16:Element-352_1>
        <ns16:Element-352_2><xsl:value-of select="concat(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:TransportationTerm/ns9:FreightTermCode,/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:TransportationTerm/ns9:IncotermsCode)"/></ns16:Element-352_2>
        </xsl:when>
        <xsl:otherwise>
        <ns16:Element-352_2><xsl:value-of select="concat(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:TransportationTerm/ns9:FreightTermCode,/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:TransportationTerm/ns9:IncotermsCode)"/></ns16:Element-352_2>
        </xsl:otherwise>
        </xsl:choose>
      </ns16:Segment-FOB>
      <ns16:Segment-ITD>
        <xsl:if test='/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:PaymentTerm/ns9:Term/ns9:ID != ""'>
          <ns16:Element-352>
            <xsl:value-of select='ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:PaymentTerm/ns9:Term/ns9:ID,1.0,60.0,0.0,"Z","ERROR")'/>
          </ns16:Element-352>
        </xsl:if>
      </ns16:Segment-ITD>
      <ns16:Loop-N9>
        <xsl:for-each select="/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:Note">
          <ns16:Segment-N9>
          <ns16:Element-128>
            <xsl:value-of select='string("L1")'/>
          </ns16:Element-128>
          <ns16:Element-127>
            <xsl:value-of select='string("PO Header Instruction to Supplier")'/>
          </ns16:Element-127>
        </ns16:Segment-N9>
          <ns16:Segment-MTX>
            <ns16:Element-363>
              <xsl:value-of select='string("OTH")'/>
            </ns16:Element-363>
            <ns16:Element-1551>
              <xsl:value-of select='ethCustomXSLT:formatValue(.,1.0,4000.0,0.0,"ZZZ","ZZZ")'/>
            </ns16:Element-1551>
          </ns16:Segment-MTX>
        </xsl:for-each>
      </ns16:Loop-N9>
      <!-- Supplier Party -->
      <ns16:Loop-N1>
        <ns16:Segment-N1>
          <ns16:Element-98>
            <xsl:value-of select='string("VN")'/>
          </ns16:Element-98>
          <ns16:Element-93>
            <xsl:value-of select="ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:SupplierParty/ns9:Name[1],1.0,60.0,0.0,'Z','ERROR')"/>
          </ns16:Element-93>
          <ns16:Element-66>
            <xsl:value-of select='string("93")'/>
          </ns16:Element-66>
          <ns16:Element-67>
            <xsl:value-of select="/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:SupplierParty/ns9:PartyIDs/ns9:ID"/>
          </ns16:Element-67>
        </ns16:Segment-N1>
        <ns16:Segment-N2>
          <ns16:Element-93>
            <xsl:value-of select="ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:SupplierParty/ns9:Name[2],1.0,60.0,0.0,'','')"/>
          </ns16:Element-93>
          <ns16:Element-93_1>
            <xsl:value-of select="ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:SupplierParty/ns9:Name[3],1.0,60.0,0.0,'','')"/>
          </ns16:Element-93_1>
        </ns16:Segment-N2>
        <ns16:Segment-N3>
          <ns16:Element-166>
            <xsl:value-of select="ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:SupplierParty/ns9:Location/ns9:Address/ns9:AddressLine[1],1.0,55.0,0.0,'Not Populated by Source','Not Populated by Source')"/>
          </ns16:Element-166>
          <ns16:Element-166_1>
          <xsl:value-of select="ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:SupplierParty/ns9:Location/ns9:Address/ns9:AddressLine[2],1.0,55.0,0.0,'Not Populated by Source','Not Populated by Source')"/>
          </ns16:Element-166_1>
        </ns16:Segment-N3>
        <ns16:Segment-N4>
          <ns16:Element-19>
                <xsl:value-of select="ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:SupplierParty/ns9:Location/ns9:Address/ns9:CityName,2.0,30.0,0.0,'ZZ','ZZ')"/>
              </ns16:Element-19>
              <ns16:Element-116>
                <xsl:value-of select="ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:SupplierParty/ns9:Location/ns9:Address/ns9:PostalCode,3.0,15.0,0.0,'ZZZ','ZZZ')"/>
              </ns16:Element-116>
                <ns16:Element-26>
                <xsl:value-of select="ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:SupplierParty/ns9:Location/ns9:Address/ns9:CountryCode,2.0,3.0,0.0,'ZZ','ZZ')"/>
              </ns16:Element-26>
          <ns16:Element-309>
            <xsl:value-of select='string("93")'/>
          </ns16:Element-309>
          <ns16:Element-310>
                <xsl:value-of select="ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:SupplierParty/ns9:Location/ns9:ID,1.0,30.0,0.0,'ZZ','ZZ')"/>
              </ns16:Element-310>
              
              <ns16:Element-1715>
                <xsl:value-of select="ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:SupplierParty/ns9:Location/ns9:Address/ns9:CountrySubDivisionCode,1.0,3.0,0.0,'ZZ','ZZ')"/>
              </ns16:Element-1715>
        </ns16:Segment-N4>
        <ns16:Segment-PER>
          <xsl:if test="/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:SupplierParty/ns9:Contact/ns9:Name[1]">
          <ns16:Element-366>
            <xsl:value-of select='string("SU")'/>
          </ns16:Element-366>
            <ns16:Element-93>
              <xsl:value-of select="ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:SupplierParty/ns9:Contact/ns9:Name[1],1.0,60.0,0.0,'ZZ','ERROR')"/>
            </ns16:Element-93>
          </xsl:if>
          <xsl:if test="/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:SupplierParty/ns9:Location/ns9:Address/ns9:UserArea/ns9:CustomPurchaseOrderHeaderUserArea/ns9:CustomPartnerUserArea/ns9:CustomPartnerAddressUserArea/ns9:Telephone[1]">
          <ns16:Element-365>
            <xsl:value-of select='string("TE")'/>
          </ns16:Element-365>
            <ns16:Element-364>
              <xsl:value-of select="ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:SupplierParty/ns9:Location/ns9:Address/ns9:UserArea/ns9:CustomPurchaseOrderHeaderUserArea/ns9:CustomPartnerUserArea/ns9:CustomPartnerAddressUserArea/ns9:Telephone[1],1.0,256.0,0.0,'ZZ','ERROR')"/>
            </ns16:Element-364>
          </xsl:if>
          <xsl:if test='/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:SupplierParty/ns9:Contact/ns9:Communication[ns9:ChannelCode = "EMAIL"]/ns9:Text'>
          <ns16:Element-365_2>
            <xsl:value-of select='string("EM")'/>
          </ns16:Element-365_2>
            <ns16:Element-364_2>
              <xsl:value-of select="ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:SupplierParty/ns9:Contact/ns9:Communication[ns9:ChannelCode = 'EMAIL']/ns9:Text,1.0,256.0,0.0,'ZZ','ERROR')"/>
            </ns16:Element-364_2>
          </xsl:if>
        </ns16:Segment-PER>
      </ns16:Loop-N1>
      <!-- Bill To Party -->
      <ns16:Loop-N1>
        <ns16:Segment-N1>
          <ns16:Element-98>
            <xsl:value-of select='string("BT")'/>
          </ns16:Element-98>
          <ns16:Element-93>
            <xsl:value-of select="ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:BillToParty/ns9:Name[1],1.0,60.0,0.0,'Z','ERROR')"/>
          </ns16:Element-93>
          <ns16:Element-66>
            <xsl:value-of select='string("93")'/>
          </ns16:Element-66>
          <ns16:Element-67>
            <xsl:value-of select="/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:BillToParty/ns9:PartyIDs/ns9:ID"/>
          </ns16:Element-67>
        </ns16:Segment-N1>
        <ns16:Segment-N2>
          <ns16:Element-93>
            <xsl:value-of select="ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:BillToParty/ns9:Name[2],1.0,60.0,0.0,'','')"/>
          </ns16:Element-93>
          <ns16:Element-93_1>
            <xsl:value-of select="ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:BillToParty/ns9:Name[3],1.0,60.0,0.0,'','')"/>
          </ns16:Element-93_1>
        </ns16:Segment-N2>
        <ns16:Segment-N3>
          <ns16:Element-166>
            <xsl:value-of select="ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:BillToParty/ns9:Location/ns9:Address/ns9:AddressLine[1],1.0,55.0,0.0,'Not Populated by Source','Not Populated by Source')"/>
          </ns16:Element-166>
          <ns16:Element-166_1>
          <xsl:value-of select="ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:BillToParty/ns9:Location/ns9:Address/ns9:AddressLine[2],1.0,55.0,0.0,'Not Populated by Source','Not Populated by Source')"/>
          </ns16:Element-166_1>
        </ns16:Segment-N3>
        <ns16:Segment-N4>
          <ns16:Element-19>
                <xsl:value-of select="ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:BillToParty/ns9:Location/ns9:Address/ns9:CityName,2.0,30.0,0.0,'ZZ','ZZ')"/>
              </ns16:Element-19>
              <ns16:Element-116>
                <xsl:value-of select="ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:BillToParty/ns9:Location/ns9:Address/ns9:PostalCode,3.0,15.0,0.0,'ZZZ','ZZZ')"/>
              </ns16:Element-116>
                <ns16:Element-26>
                <xsl:value-of select="ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:BillToParty/ns9:Location/ns9:Address/ns9:CountryCode,2.0,3.0,0.0,'ZZ','ZZ')"/>
              </ns16:Element-26>
          <ns16:Element-309>
            <xsl:value-of select='string("93")'/>
          </ns16:Element-309>
          <ns16:Element-310>
                <xsl:value-of select="ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:BillToParty/ns9:Location/ns9:ID,1.0,30.0,0.0,'ZZ','ZZ')"/>
              </ns16:Element-310>
              
              <ns16:Element-1715>
                <xsl:value-of select="ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:BillToParty/ns9:Location/ns9:Address/ns9:CountrySubDivisionCode,1.0,3.0,0.0,'ZZ','ZZ')"/>
              </ns16:Element-1715>
        </ns16:Segment-N4>
      </ns16:Loop-N1>
      <!-- Buyer Party -->
      <ns16:Loop-N1>
        <ns16:Segment-N1>
          <ns16:Element-98>
            <xsl:value-of select='string("SO")'/>
          </ns16:Element-98>
          <ns16:Element-93>
            <xsl:value-of select="ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:BuyerParty/ns9:Name[1],1.0,60.0,0.0,'Z','ERROR')"/>
          </ns16:Element-93>
          <ns16:Element-66>
            <xsl:value-of select='string("93")'/>
          </ns16:Element-66>
          <ns16:Element-67>
            <xsl:value-of select="/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:BuyerParty/ns9:PartyIDs/ns9:ID"/>
          </ns16:Element-67>
        </ns16:Segment-N1>
        <ns16:Segment-N2>
          <ns16:Element-93>
            <xsl:value-of select="ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:BuyerParty/ns9:Name[2],1.0,60.0,0.0,'','')"/>
          </ns16:Element-93>
          <ns16:Element-93_1>
            <xsl:value-of select="ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:BuyerParty/ns9:Name[3],1.0,60.0,0.0,'','')"/>
          </ns16:Element-93_1>
        </ns16:Segment-N2>
        <ns16:Segment-N3>
          <ns16:Element-166>
            <xsl:value-of select="ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:BuyerParty/ns9:Location/ns9:Address/ns9:AddressLine[1],1.0,55.0,0.0,'Not Populated by Source','Not Populated by Source')"/>
          </ns16:Element-166>
          <ns16:Element-166_1>
          <xsl:value-of select="ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:BuyerParty/ns9:Location/ns9:Address/ns9:AddressLine[2],1.0,55.0,0.0,'Not Populated by Source','Not Populated by Source')"/>
          </ns16:Element-166_1>
        </ns16:Segment-N3>
        <ns16:Segment-N4>
          <ns16:Element-19>
                <xsl:value-of select="ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:BuyerParty/ns9:Location/ns9:Address/ns9:CityName,2.0,30.0,0.0,'ZZ','ZZ')"/>
              </ns16:Element-19>
              <ns16:Element-116>
                <xsl:value-of select="ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:BuyerParty/ns9:Location/ns9:Address/ns9:PostalCode,3.0,15.0,0.0,'ZZZ','ZZZ')"/>
              </ns16:Element-116>
                <ns16:Element-26>
                <xsl:value-of select="ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:BuyerParty/ns9:Location/ns9:Address/ns9:CountryCode,2.0,3.0,0.0,'ZZ','ZZ')"/>
              </ns16:Element-26>
          <ns16:Element-309>
            <xsl:value-of select='string("93")'/>
          </ns16:Element-309>
          <ns16:Element-310>
                <xsl:value-of select="ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:BuyerParty/ns9:Location/ns9:ID,1.0,30.0,0.0,'ZZ','ZZ')"/>
              </ns16:Element-310>
              
              <ns16:Element-1715>
                <xsl:value-of select="ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:BuyerParty/ns9:Location/ns9:Address/ns9:CountrySubDivisionCode,1.0,3.0,0.0,'ZZ','ZZ')"/>
              </ns16:Element-1715>
        </ns16:Segment-N4>
      </ns16:Loop-N1>
      <!-- Carrier Party -->
      <ns16:Loop-N1>
        <ns16:Segment-N1>
          <ns16:Element-98>
            <xsl:value-of select='string("CA")'/>
          </ns16:Element-98>
          <ns16:Element-93>
            <xsl:value-of select="ethCustomXSLT:formatValue(/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderHeader/ns9:CarrierParty/ns9:Name[1],1.0,60.0,0.0,'ZZ','ZZ')"/>
          </ns16:Element-93>
          </ns16:Segment-N1>
          </ns16:Loop-N1>
      <xsl:for-each select="/imp1:CreatePurchaseOrderEBM/imp1:DataArea/imp1:CreatePurchaseOrder/ns9:PurchaseOrderLine">
        <ns16:Loop-PO1>
          <ns16:Segment-PO1>
            <ns16:Element-380>
              <xsl:value-of select="ethCustomXSLT:formatValue(ns9:Quantity,1,15,0,'ZZ','ZZ')"/>
            </ns16:Element-380>
            <ns16:Element-355>
              <xsl:value-of select="ethCustomXSLT:formatValue(ns9:Quantity/@unitCode,2,2,0,'ZZ','ZZ')"/>
            </ns16:Element-355>
            <ns16:Element-212>
              <xsl:value-of select="ethCustomXSLT:formatValue(ns9:UnitPrice/ns9:Amount,1,17,0,'0','0')"/>
            </ns16:Element-212>
            <xsl:if test="ns9:Item/ns9:ItemID/ns9:ID != ''">
              <ns16:Element-235>
                <xsl:value-of select='string("SW")'/>
              </ns16:Element-235>
            </xsl:if>
            <ns16:Element-234>
              <xsl:value-of select="ethCustomXSLT:formatValue(ns9:Item/ns9:ItemID/ns9:ID,1,48,0,'ZZ','ZZ')"/>
            </ns16:Element-234>
            <xsl:if test="ns9:Item/ns9:SupplierItemID/ns9:ID != ''">
              <ns16:Element-235_1>
                <xsl:value-of select='string("VX")'/>
              </ns16:Element-235_1>
            </xsl:if>
            <ns16:Element-234_1>
              <xsl:value-of select="ethCustomXSLT:formatValue(ns9:Item/ns9:SupplierItemID/ns9:ID,1,48,0,'ZZ','ZZ')"/>
            </ns16:Element-234_1>
            <xsl:if test="ns9:Item/ns9:ItemID/ns9:RevisionID">
              <ns16:Element-235_2>
                <xsl:value-of select='string("BE")'/>
              </ns16:Element-235_2>
            </xsl:if>
            <ns16:Element-234_2>
              <xsl:value-of select="ethCustomXSLT:formatValue(ns9:Item/ns9:ItemID/ns9:RevisionID,1,48,0,'','')"/>
            </ns16:Element-234_2>
          </ns16:Segment-PO1>
          <xsl:for-each select="ns9:Description">
            <ns16:Loop-PID>
              <ns16:Segment-PID>
                <xsl:if test=".">
                  <ns16:Element-349>
                    <xsl:value-of select='string("F")'/>
                  </ns16:Element-349>
                </xsl:if>
                <ns16:Element-352>
                  <xsl:value-of select="ethCustomXSLT:formatValue(.,1,80,0,'','')"/>
                </ns16:Element-352>
              </ns16:Segment-PID>
            </ns16:Loop-PID>
          </xsl:for-each>
          <ns16:Segment-TD4>
            <xsl:if test="ns9:Item/ns9:HazardousMaterial/ns9:ID != ''">
              <ns16:Element-152>
                <xsl:value-of select='string("HAZ")'/>
              </ns16:Element-152>
            </xsl:if>
            <ns16:Element-352>
              <xsl:value-of select="ethCustomXSLT:formatValue(ns9:Item/ns9:HazardousMaterial/ns9:ID,1,80,0,'','')"/>
            </ns16:Element-352>
          </ns16:Segment-TD4>
          <ns16:Segment-MTX>
            <ns16:Element-1551>
              <xsl:value-of select="ns9:Note[1]"/>
            </ns16:Element-1551>
          </ns16:Segment-MTX>
          <xsl:for-each select="ns9:PurchaseOrderSchedule">
            <ns16:Loop-N1>
              <ns16:Segment-SCH>
                <ns16:Element-380>
                  <xsl:value-of select="ethCustomXSLT:formatValue(ns9:Quantity,1,15,0,'0','0')"/>
                </ns16:Element-380>
                <ns16:Element-355>
                  <xsl:value-of select="ethCustomXSLT:formatValue(ns9:Quantity/@unitCode,2,2,0,'ZZ','ZZ')"/>
                </ns16:Element-355>
                
                <xsl:choose>
                  <xsl:when test="ns9:UserArea/ns9:CustomPurchaseOrderLineUserArea/ns9:CustomPurchaseOrderLineScheduleUserArea/ns9:PromisedDeliveryDateTime != ''">
                  <ns16:Element-374>
                  <xsl:value-of select="string('112')"/>
                </ns16:Element-374>
                    <ns16:Element-373>
                      <xsl:value-of select="ns9:UserArea/ns9:CustomPurchaseOrderLineUserArea/ns9:CustomPurchaseOrderLineScheduleUserArea/ns9:PromisedDeliveryDateTime"/>
                    </ns16:Element-373>
                  </xsl:when>
                  <xsl:when test="ns9:UserArea/ns9:CustomPurchaseOrderLineUserArea/ns9:CustomPurchaseOrderLineScheduleUserArea/ns9:PromisedShipDateTime != ''">
                   <ns16:Element-374>
                  <xsl:value-of select="string('112')"/>
                </ns16:Element-374>
                    <ns16:Element-373>
                      <xsl:value-of select="ns9:UserArea/ns9:CustomPurchaseOrderLineUserArea/ns9:CustomPurchaseOrderLineScheduleUserArea/ns9:PromisedShipDateTime"/>
                    </ns16:Element-373>
                  </xsl:when>
                  <xsl:otherwise>
                    <ns16:Element-373/>
                  </xsl:otherwise>
                </xsl:choose>
                <ns16:Element-350>
                  <xsl:value-of select="ethCustomXSLT:formatValue(ns9:LineNumber,1,20,0,'','')"/>
                </ns16:Element-350>
              </ns16:Segment-SCH>
            </ns16:Loop-N1>
          </xsl:for-each>
        </ns16:Loop-PO1>
      </xsl:for-each>
    </ns16:Transaction-850>
  </xsl:template>
</xsl:stylesheet>
