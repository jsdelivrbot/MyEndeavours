<?xml version="1.0" encoding="UTF-8" ?>
<?oracle-xsl-mapper
  <!-- SPECIFICATION OF MAP SOURCES AND TARGETS, DO NOT MODIFY. -->
  <mapSources>
    <source type="WSDL">
      <schema location="ETHSys_IntegrationServices_ETHSysGrp_ProcessPurchaseOrder_ETH_Transform_CustomOAGIS_9_0_RS.wsdl"/>
      <rootElement name="CustomProcessPO" namespace="http://xmlns.emrsn.com/CustomProcessPurchaseOrder"/>
    </source>
  </mapSources>
  <mapTargets>
    <target type="WSDL">
      <schema location="ETHSys_IntegrationServices_ETHSysGrp_ProcessPurchaseOrder_ETH_ProcessPO_ComplianceChecker_RS.wsdl"/>
      <rootElement name="CustomProcessPO" namespace="http://xmlns.emrsn.com/CustomProcessPurchaseOrder"/>
    </target>
  </mapTargets>
  <!-- GENERATED BY ORACLE XSL MAPPER 10.1.3.4.0(build 080718.0645) AT [WED FEB 25 13:24:50 IST 2009]. -->
?>
<xsl:stylesheet version="1.0"
                xmlns:inp1="http://xmlns.emrsn.com/CustomProcessPurchaseOrder"
                xmlns:bpws="http://schemas.xmlsoap.org/ws/2003/03/business-process/"
                xmlns:ns5="http://www.openapplications.org/oagis/9/unqualifieddatatypes/1.1"
                xmlns:ehdr="http://www.oracle.com/XSL/Transform/java/oracle.tip.esb.server.headers.ESBHeaderFunctions"
                xmlns:ns7="http://www.openapplications.org/oagis/9/currencycode/54217:2001"
                xmlns:ns4="http://www.openapplications.org/oagis/9/qualifieddatatypes/1.1"
                xmlns:ns1="http://www.openapplications.org/oagis/9/IANAMIMEMediaTypes:2003"
                xmlns:ns0="http://www.w3.org/2001/XMLSchema"
                xmlns:ns2="http://www.openapplications.org/oagis/9/codelists"
                xmlns:hwf="http://xmlns.oracle.com/bpel/workflow/xpath"
                xmlns:xp20="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.Xpath20"
                xmlns:xref="http://www.oracle.com/XSL/Transform/java/oracle.tip.xref.xpath.XRefXPathFunctions"
                xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:ora="http://schemas.oracle.com/xpath/extension"
                xmlns:ids="http://xmlns.oracle.com/bpel/services/IdentityService/xpath"
                xmlns:orcl="http://www.oracle.com/XSL/Transform/java/oracle.tip.pc.services.functions.ExtFunc"
                xmlns:tns="http://oracle.com/esb/namespaces/ETHSys_IntegrationServices_ETHSysGrp_ProcessPurchaseOrder"
                xmlns:imp1="http://www.openapplications.org/oagis/9"
                xmlns:ns6="http://www.openapplications.org/oagis/9/unitcode/66411:2001"
                xmlns:ns8="http://www.openapplications.org/oagis/9/languagecode/5639:1988"
                xmlns:eth="http://www.oracle.com/XSL/Transform/java/ETHComplianceCheck.functions.ETHComplianceCheck"
                exclude-result-prefixes="xsl eth inp1 imp1 ns5 ns7 ns4 ns1 ns0 ns2 tns ns6 ns8 bpws ehdr hwf xp20 xref ora ids orcl">
  <xsl:template match="/">
    <inp1:CustomProcessPO>
      <ProcessPO>
        <xsl:attribute name="releaseID">
          <xsl:value-of select="/inp1:CustomProcessPO/ProcessPO/@releaseID"/>
        </xsl:attribute>
        <!--Added as on 26 dec-->
  <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID ='LIEBERTNA'">
        <xsl:attribute name="systemEnvironmentCode">
          <xsl:value-of select="/inp1:CustomProcessPO/ProcessPO/@systemEnvironmentCode"/>
        </xsl:attribute>
</xsl:if>
        <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID !='LIEBERTNA'">
          <xsl:attribute name="versionID">
            <xsl:value-of select="/inp1:CustomProcessPO/ProcessPO/@versionID"/>
          </xsl:attribute>
        </xsl:if>
        <xsl:attribute name="languageCode">
          <xsl:value-of select="/inp1:CustomProcessPO/ProcessPO/@languageCode"/>
        </xsl:attribute>
        <imp1:ApplicationArea>
          <imp1:Sender>
            <imp1:LogicalID>
              <xsl:value-of select="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID"/>
            </imp1:LogicalID>
            <imp1:ComponentID>
              <xsl:value-of select="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:ComponentID"/>
            </imp1:ComponentID>
            <imp1:TaskID>
              <xsl:value-of select="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:TaskID"/>
            </imp1:TaskID>
            <!--ADDED AS ON 3 DEC-->
            <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:ReferenceID !=''">
              <imp1:ReferenceID>
                <xsl:value-of select="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:ReferenceID"/>
              </imp1:ReferenceID>
            </xsl:if>
            <imp1:ConfirmationCode>
              <xsl:value-of select="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:ConfirmationCode"/>
            </imp1:ConfirmationCode>
            <imp1:AuthorizationID>
              <xsl:value-of select="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:AuthorizationID"/>
            </imp1:AuthorizationID>
          </imp1:Sender>
          <imp1:CreationDateTime>
            <xsl:value-of select="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:CreationDateTime"/>
          </imp1:CreationDateTime>
        </imp1:ApplicationArea>
        <DataArea>
          <imp1:Process/>
          <!--Added as on 26 NOV-->
          <xsl:for-each select="/inp1:CustomProcessPO/ProcessPO/DataArea/imp1:PurchaseOrder">
            <!--8 DEC-->
            <imp1:PurchaseOrder>
              <!--HEADER-->
              <imp1:PurchaseOrderHeader>
                <imp1:DocumentID>
                  <!--LookUp Added -->
                  <xsl:variable name="LENGTH_POID">
                    <xsl:value-of select="string-length(imp1:PurchaseOrderHeader/imp1:DocumentID/imp1:ID)"/>
                  </xsl:variable>
                  <xsl:variable name="POID_Sub">
                    <xsl:value-of select="substring(imp1:PurchaseOrderHeader/imp1:DocumentID/imp1:ID,1.0,3.0)"/>
                  </xsl:variable>
                  <xsl:variable name="POID_Name" select="COMPLIANCE_ERROR"/>
                  <xsl:variable name="POID_Final">
                    <xsl:value-of select="contains($POID_Name,'COMPLIANCE_ERROR')"/>
                  </xsl:variable>
                  <xsl:choose>
                    <xsl:when test="($POID_Final='true') or ($LENGTH_POID > 20)">
                      <imp1:ID>
                        <xsl:value-of select='concat(imp1:PurchaseOrderHeader/imp1:DocumentID/imp1:ID,"COMPLIANCE_ERROR")'/>
                      </imp1:ID>
                    </xsl:when>
                    <xsl:otherwise>
                      <imp1:ID>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:DocumentID/imp1:ID"/>
                      </imp1:ID>
                    </xsl:otherwise>
                  </xsl:choose>
                  <!-- 17 Apr 2009 Process PO Issue # 135 -->
                  <!-- <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID ='LIEBERTNA'">-->
                    <imp1:RevisionID>
                      <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:DocumentID/imp1:RevisionID"/>
                    </imp1:RevisionID>
                  <!--</xsl:if> -->
                  <!-- 17 Apr 2009 -->
                  <imp1:VariationID>
                    <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:DocumentID/imp1:VariationID"/>
                  </imp1:VariationID>
                </imp1:DocumentID>
                <imp1:DocumentDateTime>
                  <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:DocumentDateTime"/>
                </imp1:DocumentDateTime>
                <imp1:Description>
                  <!-- Added as on 26 NOV -->
                  <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:Description"/>
                </imp1:Description>
                <xsl:for-each select="imp1:PurchaseOrderHeader/imp1:Note">
                  <imp1:Note>
                    <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID !='LIEBERTNA'">
                      <xsl:attribute name="author">
                        <xsl:value-of select="@author"/>
                      </xsl:attribute>
                    </xsl:if>
                    <xsl:value-of select="."/>
                  </imp1:Note>
                </xsl:for-each>
                <!-- <imp1:Note>
                <xsl:value-of select="/inp1:CustomProcessPO/ProcessPO/DataArea/imp1:PurchaseOrder/imp1:PurchaseOrderHeader/imp1:Note[2]"/>
              </imp1:Note>
              <imp1:Note>
                <xsl:value-of select="/inp1:CustomProcessPO/ProcessPO/DataArea/imp1:PurchaseOrder/imp1:PurchaseOrderHeader/imp1:Note[3]"/>
              </imp1:Note>-->
                <!-- SupplierParty -->
                <imp1:SupplierParty>
                  <imp1:PartyIDs>
                    <!--LookUp Added -->
                    <xsl:variable name="LENGTH_ID">
                      <xsl:value-of select="string-length(imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:PartyIDs/imp1:ID)"/>
                    </xsl:variable>
                    <xsl:variable name="PartyID_Sub">
                      <xsl:value-of select="substring(imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:PartyIDs/imp1:ID,1.0,3.0)"/>
                    </xsl:variable>
                    <xsl:variable name="PartyID_Name" select="COMPLIANCE_ERROR"/>
                    <xsl:variable name="PartyID_Final">
                      <xsl:value-of select="contains($PartyID_Name,'COMPLIANCE_ERROR')"/>
                    </xsl:variable>
                    <xsl:choose>
                      <xsl:when test="($PartyID_Final='true') or ($LENGTH_ID > 20)">
                        <imp1:ID>
                          <xsl:value-of select='concat(imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:PartyIDs/imp1:ID,"COMPLIANCE_ERROR")'/>
                        </imp1:ID>
                      </xsl:when>
                      <xsl:otherwise>
                        <imp1:ID>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:PartyIDs/imp1:ID"/>
                        </imp1:ID>
                      </xsl:otherwise>
                    </xsl:choose>
                    <!--ADDED AS ON 3 DEC-->
                    <xsl:choose>
                      <xsl:when test='/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID !="LIEBERTNA"'>
                        <imp1:TaxID>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:PartyIDs/imp1:TaxID"/>
                        </imp1:TaxID>
                        <imp1:DUNSID>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:PartyIDs/imp1:DUNSID"/>
                        </imp1:DUNSID>
                      </xsl:when>
                    </xsl:choose>
                  </imp1:PartyIDs>
                  <!-- DVM Lookup Updated : 22 Mar -->
                  <xsl:choose>   
                      <xsl:when test="imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Name = ''">
                          <imp1:Name>
                            <xsl:value-of select="string('COMPLIANCE_ERROR')"/>
                          </imp1:Name>
                      </xsl:when>
                      <xsl:when test="(xp20:compare(imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Name,xp20:upper-case(imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Name))) = 0">
                          <imp1:Name>
                            <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Name"/>                            
                          </imp1:Name>
                      </xsl:when>
                      <xsl:otherwise>
                          <imp1:Name>
                            <xsl:value-of select="concat(imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Name,'COMPLIANCE_EXCEPTION')"/>
                          </imp1:Name>
                      </xsl:otherwise>
                  </xsl:choose>
                  <!-- DVM Lookup Updated : 22 Mar -->
                  <imp1:Location>
                    <imp1:ID>
                      <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Location/imp1:ID"/>
                    </imp1:ID>
                    <imp1:Address>
                      <imp1:LineOne>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Location/imp1:Address/imp1:LineOne"/>
                      </imp1:LineOne>
                      <imp1:LineTwo>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Location/imp1:Address/imp1:LineTwo"/>
                      </imp1:LineTwo>
                      <imp1:LineThree>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Location/imp1:Address/imp1:LineThree"/>
                      </imp1:LineThree>
                      <imp1:LineFour>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Location/imp1:Address/imp1:LineFour"/>
                      </imp1:LineFour>
                      <imp1:CityName>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Location/imp1:Address/imp1:CityName"/>
                      </imp1:CityName>
                      <!--LookUp Added -->
                      <!--<imp1:CountrySubDivisionCode>
                     <xsl:value-of select="orcl:lookup-dvm('Country Subdivisions','Country Subdivision Code',/inp1:CustomProcessPO/ProcessPO/DataArea/imp1:PurchaseOrder/imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode,'Target',concat(/inp1:CustomProcessPO/ProcessPO/DataArea/imp1:PurchaseOrder/imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode,&quot;COMPLIANCE_ERROR&quot;))"/>
                  </imp1:CountrySubDivisionCode>-->
                      <!--LookUp Added with choose condition on 12 Nov -->
                      <!-- Updated : 17 Apr -->
                      <!-- DVM Lookup Updated : 22 Mar -->
                      <!--
                      <imp1:CountrySubDivisionCode>                            
                        <xsl:value-of select="orcl:lookup-dvm('Country Subdivisions','Country and Subdivision Code',concat(imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Location/imp1:Address/imp1:CountryCode,'-',imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode),'Target',concat(imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode,&quot;COMPLIANCE_ERROR&quot;))"/>
                      </imp1:CountrySubDivisionCode>
                      -->
                      <xsl:choose>
                        <xsl:when test='imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode !=""'>
                          <imp1:CountrySubDivisionCode>                            
                            <!--<xsl:value-of select="orcl:lookup-dvm('Country Subdivisions','Country and Subdivision Code',imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode,'Target',concat(imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode,&quot;COMPLIANCE_ERROR&quot;))"/>-->
                            <xsl:value-of select="orcl:lookup-dvm('Country Subdivisions','Country and Subdivision Code',concat(imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Location/imp1:Address/imp1:CountryCode,'-',imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode),'Target',concat(imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode,&quot;COMPLIANCE_ERROR&quot;))"/>
                            <!--<xsl:value-of select="string('US')"/>-->
                          </imp1:CountrySubDivisionCode>
                        </xsl:when>
                        <xsl:otherwise>
                          <imp1:CountrySubDivisionCode>
                            <xsl:value-of select='imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode'/>
                          </imp1:CountrySubDivisionCode>
                        </xsl:otherwise>
                      </xsl:choose>
                      <!-- DVM Lookup Updated : 22 Mar -->
                      <!-- Updated : 17 Apr -->
                      <!--LookUp Added -->
                      <!--<imp1:CountryCode>
                    <xsl:value-of select="orcl:lookup-dvm('Countries','Country Code',/inp1:CustomProcessPO/ProcessPO/DataArea/imp1:PurchaseOrder/imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Location/imp1:Address/imp1:CountryCode,'Target',concat(/inp1:CustomProcessPO/ProcessPO/DataArea/imp1:PurchaseOrder/imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Location/imp1:Address/imp1:CountryCode,&quot;COMPLIANCE_ERROR&quot;))"/>
                </imp1:CountryCode> -->
                      <!--LookUp Added with choose condition on 12 Nov -->
                      <!-- DVM Lookup Updated : 22 Mar -->
                      <imp1:CountryCode>Canada</imp1:CountryCode>
                      <!--
                      <xsl:choose>
                        <xsl:when test='imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Location/imp1:Address/imp1:CountryCode !=""'>
                          <imp1:CountryCode>
                            <xsl:value-of select="orcl:lookup-dvm('Countries','Country Code',imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Location/imp1:Address/imp1:CountryCode,'Target',concat(imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Location/imp1:Address/imp1:CountryCode,&quot;COMPLIANCE_ERROR&quot;))"/>
                          </imp1:CountryCode>
                        </xsl:when>
                        <xsl:otherwise>
                          <imp1:CountryCode>
                            <xsl:value-of select='imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Location/imp1:Address/imp1:CountryCode'/>
                          </imp1:CountryCode>
                        </xsl:otherwise>
                      </xsl:choose>
                      -->
                      <!-- DVM Lookup Updated : 22 Mar -->
                      <imp1:PostalCode>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Location/imp1:Address/imp1:PostalCode"/>
                      </imp1:PostalCode>
                    </imp1:Address>
                    <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID !='LIEBERTNA'">
                      <!--8 DEC-->
                      <imp1:Description>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Location/imp1:Description"/>
                      </imp1:Description>
                      <imp1:Note>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Location/imp1:Note"/>
                      </imp1:Note>
                      <imp1:UserArea>
                        <xsl:for-each select="imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Location/imp1:UserArea/imp1:Note">
                          <imp1:Note>
                            <xsl:attribute name="author">
                              <xsl:value-of select="@author"/>
                            </xsl:attribute>
                            <xsl:value-of select="."/>
                          </imp1:Note>
                        </xsl:for-each>
                      </imp1:UserArea>
                    </xsl:if>
                    <!--8 DEC-->
                  </imp1:Location>
                  <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID !='LIEBERTNA'">
                    <!--8 DEC-->
                    <imp1:Contact>
                      <imp1:Communication>
                        <imp1:ChannelCode>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Contact/imp1:Communication[1]/imp1:ChannelCode[1.0]"/>
                        </imp1:ChannelCode>
                        <imp1:DialNumber>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Contact/imp1:Communication[1]/imp1:DialNumber"/>
                        </imp1:DialNumber>
                      </imp1:Communication>
                      <imp1:Communication>
                        <imp1:ChannelCode>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Contact/imp1:Communication[2]/imp1:ChannelCode"/>
                        </imp1:ChannelCode>
                        <imp1:DialNumber>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Contact/imp1:Communication[2]/imp1:DialNumber"/>
                        </imp1:DialNumber>
                      </imp1:Communication>
                      <imp1:Communication>
                        <imp1:ChannelCode>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Contact/imp1:Communication[3]/imp1:ChannelCode"/>
                        </imp1:ChannelCode>
                        <imp1:DialNumber>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Contact/imp1:Communication[3]/imp1:DialNumber"/>
                        </imp1:DialNumber>
                      </imp1:Communication>
                      <imp1:Communication>
                        <imp1:ChannelCode>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Contact/imp1:Communication[4]/imp1:ChannelCode"/>
                        </imp1:ChannelCode>
                        <imp1:DialNumber>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Contact/imp1:Communication[4]/imp1:DialNumber"/>
                        </imp1:DialNumber>
                      </imp1:Communication>
                    </imp1:Contact>
                  </xsl:if>
                  <!--8 DEC-->
                  <imp1:CustomerServiceContact>
                    <imp1:Name>
                      <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:CustomerServiceContact/imp1:Name"/>
                    </imp1:Name>
                    <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID !='LIEBERTNA'">
                      <!--8 DEC-->
                      <imp1:JobTitle>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:CustomerServiceContact/imp1:JobTitle"/>
                      </imp1:JobTitle>
                    </xsl:if>
                    <!--8 DEC-->
                    <imp1:Communication>
                      <imp1:ChannelCode>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:CustomerServiceContact/imp1:Communication[1]/imp1:ChannelCode"/>
                      </imp1:ChannelCode>
                      <imp1:URI>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:CustomerServiceContact/imp1:Communication[1]/imp1:URI"/>
                      </imp1:URI>
                    </imp1:Communication>
                    <imp1:Communication>
                      <imp1:ChannelCode>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:CustomerServiceContact/imp1:Communication[2]/imp1:ChannelCode"/>
                      </imp1:ChannelCode>
                      <imp1:DialNumber>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:CustomerServiceContact/imp1:Communication[2]/imp1:DialNumber"/>
                      </imp1:DialNumber>
                    </imp1:Communication>
                    <imp1:Communication>
                      <imp1:ChannelCode>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:CustomerServiceContact/imp1:Communication[3]/imp1:ChannelCode"/>
                      </imp1:ChannelCode>
                      <imp1:DialNumber>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:CustomerServiceContact/imp1:Communication[3]/imp1:DialNumber"/>
                      </imp1:DialNumber>
                    </imp1:Communication>
                  </imp1:CustomerServiceContact>
                  <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID !='LIEBERTNA'">
                    <!--8 DEC-->
                    <imp1:UserArea>
                      <xsl:for-each select="imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:UserArea/imp1:Note">
                        <imp1:Note>
                          <xsl:attribute name="author">
                            <xsl:value-of select="@author"/>
                          </xsl:attribute>
                          <xsl:value-of select="."/>
                        </imp1:Note>
                      </xsl:for-each>
                    </imp1:UserArea>
                  </xsl:if>
                  <!--8 DEC-->
                </imp1:SupplierParty>
                <imp1:ContractReference>
                  <imp1:DocumentID>
                    <imp1:ID>
                      <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:ContractReference/imp1:DocumentID/imp1:ID"/>
                    </imp1:ID>
                  </imp1:DocumentID>
                  <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID != 'LIEBERTNA'">
                    <!--8 DEC-->
                    <imp1:AlternateDocumentID>
                      <imp1:ID>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:ContractReference/imp1:AlternateDocumentID/imp1:ID"/>
                      </imp1:ID>
                    </imp1:AlternateDocumentID>
                  </xsl:if>
                  <!--8 DEC-->
                </imp1:ContractReference>
                <!-- <imp1:ExtendedAmount>
              <xsl:attribute name="currencyID">
                <xsl:value-of select="/inp1:CustomProcessPO/ProcessPO/DataArea/imp1:PurchaseOrder/imp1:PurchaseOrderHeader/imp1:ExtendedAmount/@currencyID"/>
              </xsl:attribute>
              <xsl:value-of select="/inp1:CustomProcessPO/ProcessPO/DataArea/imp1:PurchaseOrder/imp1:PurchaseOrderHeader/imp1:ExtendedAmount"/>
            </imp1:ExtendedAmount> -->
                <!--LookUp Added with if condition on 12 Nov -->
                <imp1:ExtendedAmount>
                <!-- DVM Lookup Updated : 22 Mar -->
                <!--  <xsl:if test="imp1:PurchaseOrderHeader/imp1:ExtendedAmount/@currencyID !=''">-->
                    <xsl:attribute name="currencyID">
                      <xsl:value-of select="USD"/>
                    </xsl:attribute>                    
                  <!--</xsl:if>-->
                  <!-- Added on 12 NOV -->
                  <!--
                  <xsl:if test="imp1:PurchaseOrderHeader/imp1:ExtendedAmount/@currencyID =''">
                    <xsl:attribute name="currencyID">
                      <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:ExtendedAmount/@currencyID"/>
                    </xsl:attribute>
                  </xsl:if>
                  -->
                  <!-- Added on 12 NOV -->
                  <!-- DVM Lookup Updated : 22 Mar -->
                  <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:ExtendedAmount"/>
                </imp1:ExtendedAmount>
                <!--BillToParty-->
                <imp1:BillToParty>
                  <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID !='LIEBERTNA'">
                    <!--8 DEC-->
                    <imp1:PartyIDs>
                      <imp1:ID>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:PartyIDs/imp1:ID"/>
                      </imp1:ID>
                      <imp1:TaxID>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:PartyIDs/imp1:TaxID"/>
                      </imp1:TaxID>
                      <imp1:DUNSID>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:PartyIDs/imp1:DUNSID"/>
                      </imp1:DUNSID>
                    </imp1:PartyIDs>
                  </xsl:if>
                  <!--8 DEC-->
                  <imp1:Name>
                    <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Name"/>
                  </imp1:Name>
                  <imp1:Location>
                    <imp1:ID>
                      <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Location/imp1:ID"/>
                    </imp1:ID>
                    <imp1:Address>
                      <imp1:LineOne>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Location/imp1:Address/imp1:LineOne"/>
                      </imp1:LineOne>
                      <imp1:LineTwo>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Location/imp1:Address/imp1:LineTwo"/>
                      </imp1:LineTwo>
                      <imp1:LineThree>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Location/imp1:Address/imp1:LineThree"/>
                      </imp1:LineThree>
                      <imp1:LineFour>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Location/imp1:Address/imp1:LineFour"/>
                      </imp1:LineFour>
                      <imp1:CityName>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Location/imp1:Address/imp1:CityName"/>
                      </imp1:CityName>
                      <!--LookUp Added -->
                      <!--<imp1:CountrySubDivisionCode>
                     <xsl:value-of select="orcl:lookup-dvm('Country Subdivisions','Country Subdivision Code',/inp1:CustomProcessPO/ProcessPO/DataArea/imp1:PurchaseOrder/imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode,'Target',concat(/inp1:CustomProcessPO/ProcessPO/DataArea/imp1:PurchaseOrder/imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode,&quot;COMPLIANCE_ERROR&quot;))"/>
                  </imp1:CountrySubDivisionCode>-->
                      <!--LookUp Added with choose condition on 12 Nov -->
                      <!-- Updated : 17 Apr -->
                      <!-- DVM Lookup Updated : 22 Mar -->
                      <!--
                      <imp1:CountrySubDivisionCode>                            
                        <xsl:value-of select="orcl:lookup-dvm('Country Subdivisions','Country and Subdivision Code',concat(imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Location/imp1:Address/imp1:CountryCode,'-',imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode),'Target',concat(imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode,&quot;COMPLIANCE_ERROR&quot;))"/>
                      </imp1:CountrySubDivisionCode>
                      -->
                      <xsl:choose>
                        <xsl:when test='imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode !=""'>
                          <imp1:CountrySubDivisionCode>                            
                            <!--<xsl:value-of select="orcl:lookup-dvm('Country Subdivisions','Subdivision Code',imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode,'Target',concat(imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode,&quot;COMPLIANCE_ERROR&quot;))"/>-->
                            <xsl:value-of select="orcl:lookup-dvm('Country Subdivisions','Country and Subdivision Code',concat(imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Location/imp1:Address/imp1:CountryCode,'-',imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode),'Target',concat(imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode,&quot;COMPLIANCE_ERROR&quot;))"/>
                            <!--<xsl:value-of select="string('US')"/>-->
                          </imp1:CountrySubDivisionCode>
                        </xsl:when>
                        <xsl:otherwise>
                          <imp1:CountrySubDivisionCode>
                            <xsl:value-of select='imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode'/>
                          </imp1:CountrySubDivisionCode>
                        </xsl:otherwise>
                      </xsl:choose>
                      <!-- DVM Lookup Updated : 22 Mar -->
                      <!-- Updated : 17 Apr -->
                      <!--LookUp Added -->
                      <!--<imp1:CountryCode>
                   <xsl:value-of select="orcl:lookup-dvm('Countries','Country Code',/inp1:CustomProcessPO/ProcessPO/DataArea/imp1:PurchaseOrder/imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Location/imp1:Address/imp1:CountryCode,'Target',concat(/inp1:CustomProcessPO/ProcessPO/DataArea/imp1:PurchaseOrder/imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Location/imp1:Address/imp1:CountryCode,&quot;COMPLIANCE_ERROR&quot;))"/>
                  </imp1:CountryCode> -->
                      <!--LookUp Added with choose condition on 12 Nov -->
                      <!-- DVM Lookup Updated : 22 Mar -->
                      <imp1:CountryCode>Canada</imp1:CountryCode>
                      <!--
                      <xsl:choose>
                        <xsl:when test='imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Location/imp1:Address/imp1:CountryCode !=""'>
                          <imp1:CountryCode>
                            <xsl:value-of select="orcl:lookup-dvm('Countries','Country Code',imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Location/imp1:Address/imp1:CountryCode,'Target',concat(imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Location/imp1:Address/imp1:CountryCode,&quot;COMPLIANCE_ERROR&quot;))"/>
                          </imp1:CountryCode>
                        </xsl:when>
                        <xsl:otherwise>
                          <imp1:CountryCode>
                            <xsl:value-of select='imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Location/imp1:Address/imp1:CountryCode'/>
                          </imp1:CountryCode>
                        </xsl:otherwise>
                      </xsl:choose>
                      -->
                      <!-- DVM Lookup Updated : 22 Mar -->
                      <imp1:PostalCode>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Location/imp1:Address/imp1:PostalCode"/>
                      </imp1:PostalCode>
                      <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID !='LIEBERTNA'">
                        <!--8 DEC-->
                        <imp1:UserArea/>
                      </xsl:if>
                      <!--8 DEC-->
                    </imp1:Address>
                    <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID !='LIEBERTNA'">
                      <!--8 DEC-->
                      <imp1:Description>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Location/imp1:Description"/>
                      </imp1:Description>
                      <xsl:for-each select="imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Location/imp1:Note">
                        <imp1:Note>
                          <xsl:value-of select="."/>
                        </imp1:Note>
                      </xsl:for-each>
                      <imp1:UserArea/>
                    </xsl:if>
                    <!--8 DEC-->
                  </imp1:Location>
                  <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID !='LIEBERTNA'">
                    <!--8 DEC-->
                    <imp1:Contact>
                      <imp1:Communication>
                        <imp1:ChannelCode>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Contact/imp1:Communication[1]/imp1:ChannelCode"/>
                        </imp1:ChannelCode>
                        <imp1:DialNumber>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Contact/imp1:Communication[1]/imp1:DialNumber"/>
                        </imp1:DialNumber>
                      </imp1:Communication>
                      <imp1:Communication>
                        <imp1:ChannelCode>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Contact/imp1:Communication[2]/imp1:ChannelCode"/>
                        </imp1:ChannelCode>
                        <imp1:DialNumber>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Contact/imp1:Communication[2]/imp1:DialNumber"/>
                        </imp1:DialNumber>
                      </imp1:Communication>
                      <imp1:Communication>
                        <imp1:ChannelCode>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Contact/imp1:Communication[3]/imp1:ChannelCode"/>
                        </imp1:ChannelCode>
                        <imp1:DialNumber>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Contact/imp1:Communication[3]/imp1:DialNumber"/>
                        </imp1:DialNumber>
                      </imp1:Communication>
                      <imp1:Communication>
                        <imp1:ChannelCode>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Contact/imp1:Communication[4]/imp1:ChannelCode"/>
                        </imp1:ChannelCode>
                        <imp1:DialNumber>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:Contact/imp1:Communication[4]/imp1:DialNumber"/>
                        </imp1:DialNumber>
                      </imp1:Communication>
                    </imp1:Contact>
                  </xsl:if>
                  <!--8 DEC-->
                  <imp1:BuyerContact>
                    <imp1:Name>
                      <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:BuyerContact/imp1:Name"/>
                    </imp1:Name>
                    <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID !='LIEBERTNA'">
                      <!--8 DEC-->
                      <imp1:JobTitle>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:BuyerContact/imp1:JobTitle"/>
                      </imp1:JobTitle>
                    </xsl:if>
                    <!--8 DEC-->
                    <imp1:Communication>
                      <imp1:ChannelCode>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:BuyerContact/imp1:Communication[1]/imp1:ChannelCode"/>
                      </imp1:ChannelCode>
                      <imp1:URI>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:BuyerContact/imp1:Communication[1]/imp1:URI"/>
                      </imp1:URI>
                    </imp1:Communication>
                    <imp1:Communication>
                      <imp1:ChannelCode>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:BuyerContact/imp1:Communication[2]/imp1:ChannelCode"/>
                      </imp1:ChannelCode>
                      <imp1:DialNumber>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:BuyerContact/imp1:Communication[2]/imp1:DialNumber"/>
                      </imp1:DialNumber>
                    </imp1:Communication>
                    <imp1:Communication>
                      <imp1:ChannelCode>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:BuyerContact/imp1:Communication[3]/imp1:ChannelCode"/>
                      </imp1:ChannelCode>
                      <imp1:DialNumber>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BillToParty/imp1:BuyerContact/imp1:Communication[3]/imp1:DialNumber"/>
                      </imp1:DialNumber>
                    </imp1:Communication>
                  </imp1:BuyerContact>
                </imp1:BillToParty>
                <imp1:CarrierParty>
                  <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID !='LIEBERTNA'">
                    <!--8 DEC-->
                    <imp1:PartyIDs>
                      <imp1:ID>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:CarrierParty/imp1:PartyIDs/imp1:ID"/>
                      </imp1:ID>
                    </imp1:PartyIDs>
                  </xsl:if>
                  <!--8 DEC-->
                  <imp1:Name>
                    <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:CarrierParty/imp1:Name"/>
                  </imp1:Name>
                  <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID !='LIEBERTNA'">
                    <!--8 DEC-->
                    <imp1:Location>
                      <imp1:ID>
                        <xsl:value-of select="imp1:ID"/>
                      </imp1:ID>
                    </imp1:Location>
                  </xsl:if>
                  <!--8 DEC-->
                  <xsl:for-each select="imp1:PurchaseOrderHeader/imp1:CarrierParty/imp1:Location/imp1:Note">
                    <imp1:Note>
                      <xsl:value-of select="."/>
                    </imp1:Note>
                  </xsl:for-each>
                </imp1:CarrierParty>
                <imp1:TransportationTerm>
                  <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID !='LIEBERTNA'">
                    <!--8 DEC-->
                    <imp1:IncotermsCode>
                      <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:TransportationTerm/imp1:IncotermsCode"/>
                    </imp1:IncotermsCode>
                  </xsl:if>
                  <!--8 DEC-->
                  <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID ='LIEBERTNA'">
                    <imp1:PlaceOfOwnershipTransferLocation>
                      <imp1:Name>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:TransportationTerm/imp1:PlaceOfOwnershipTransferLocation/imp1:Name"/>
                      </imp1:Name>
                    </imp1:PlaceOfOwnershipTransferLocation>
                  </xsl:if>
                  <!--LookUp Added -->
                  <!-- <imp1:FreightTermCode>
                <xsl:value-of select="orcl:lookup-dvm('Freight Terms','Freight Term Code',/inp1:CustomProcessPO/ProcessPO/DataArea/imp1:PurchaseOrder/imp1:PurchaseOrderHeader/imp1:TransportationTerm/imp1:FreightTermCode ,'Target',concat(/inp1:CustomProcessPO/ProcessPO/DataArea/imp1:PurchaseOrder/imp1:PurchaseOrderHeader/imp1:TransportationTerm/imp1:FreightTermCode,&quot;COMPLIANCE_ERROR&quot;))"/>
              </imp1:FreightTermCode>-->
                  <!--LookUp Added with choose condition on 12 Nov -->
                  <!-- DVM Lookup Updated : 22 Mar -->
                  <imp1:FreightTermCode>COMPLIANCE_ERROR</imp1:FreightTermCode>
                  <!--
                  <xsl:choose>
                    <xsl:when test='imp1:PurchaseOrderHeader/imp1:TransportationTerm/imp1:FreightTermCode !=""'>
                      <imp1:FreightTermCode>
                        <xsl:value-of select="orcl:lookup-dvm('Freight Terms','Freight Term Code',imp1:PurchaseOrderHeader/imp1:TransportationTerm/imp1:FreightTermCode ,'Target',concat(imp1:PurchaseOrderHeader/imp1:TransportationTerm/imp1:FreightTermCode,&quot;COMPLIANCE_ERROR&quot;))"/>
                      </imp1:FreightTermCode>
                    </xsl:when>
                    <xsl:otherwise>
                      <imp1:FreightTermCode>
                        <xsl:value-of select='imp1:PurchaseOrderHeader/imp1:TransportationTerm/imp1:FreightTermCode'/>
                      </imp1:FreightTermCode>
                    </xsl:otherwise>
                  </xsl:choose>
                  -->
                  <!-- DVM Lookup Updated : 22 Mar -->
                  <!--   <imp1:UserArea>
                <imp1:Note>
                  <xsl:value-of select="/inp1:CustomProcessPO/ProcessPO/DataArea/imp1:PurchaseOrder/imp1:PurchaseOrderHeader/imp1:TransportationTerm/imp1:UserArea/imp1:Note"/>
                </imp1:Note>
              </imp1:UserArea> -->
                  <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID !='LIEBERTNA'">
                    <!--8 DEC-->
                    <imp1:UserArea>
                      <!-- ADDED AS ON 29 OCT -->
                      <imp1:Note>
                        <xsl:attribute name="author">
                          <xsl:value-of select="string('Incoterm Description')"/>
                        </xsl:attribute>
                        <!--<xsl:value-of select="imp1:PurchaseOrderHeader/imp1:TransportationTerm/imp1:IncotermsCode"/>-->
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:TransportationTerm/imp1:UserArea/imp1:Note[1]"/>
                      </imp1:Note>
                      <imp1:Note>
                        <xsl:attribute name="author">
                          <xsl:value-of select="string('Freight Term Description')"/>
                        </xsl:attribute>
                        <!--<xsl:value-of select="imp1:PurchaseOrderHeader/imp1:TransportationTerm/imp1:FreightTermCode"/>-->
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:TransportationTerm/imp1:UserArea/imp1:Note[2]"/>
                      </imp1:Note>
                    </imp1:UserArea>
                  </xsl:if>
                  <!--8 DEC-->
                </imp1:TransportationTerm>
                <imp1:PaymentTerm>
                  <imp1:Term>
                    <!-- DVM Lookup Updated : 22 Mar -->
                    <!-- 17 Apr 2009 : Updated to use User Defined Extension Function ethComplianceCheck -->
                    <xsl:variable name="PaymentTerm_Var" select="Success"/>
                        <!--<xsl:value-of select="eth:ethComplianceCheck(imp1:PurchaseOrderHeader/imp1:PaymentTerm/imp1:Term/imp1:ID,'PaymentTerm')"/>
                    </xsl:variable>-->
                    <xsl:choose>
                      <xsl:when test='$PaymentTerm_Var = "Success"'>
                        <imp1:ID>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:PaymentTerm/imp1:Term/imp1:ID"/>
                        </imp1:ID>
                      </xsl:when>
                      <xsl:when test='$PaymentTerm_Var = "Failure"'>
                        <imp1:ID>
                          <xsl:value-of select="concat(imp1:PurchaseOrderHeader/imp1:PaymentTerm/imp1:Term/imp1:ID,'COMPLIANCE_ERROR')"/>
                        </imp1:ID>
                      </xsl:when>
                      <xsl:otherwise>
                        <imp1:ID>
                          <xsl:value-of select="string('Invalid')"/>
                        </imp1:ID>
                      </xsl:otherwise>
                    </xsl:choose>
                    <!--
                    <imp1:ID>
                        <xsl:value-of select="orcl:lookup-dvm('Payment Terms','Payment Term Code',imp1:PurchaseOrderHeader/imp1:PaymentTerm/imp1:Term/imp1:ID,'Target',concat(imp1:PurchaseOrderHeader/imp1:PaymentTerm/imp1:Term/imp1:ID,&quot;COMPLIANCE_ERROR&quot;))"/>
                    </imp1:ID> -->
                    <!-- Updated : 17 Apr 2009 -->
                    <!--LookUp Added with choose condition on 12 Nov -->
                    <!--
                    <xsl:choose>
                      <xsl:when test='imp1:PurchaseOrderHeader/imp1:PaymentTerm/imp1:Term/imp1:ID !=""'>
                        <imp1:ID>
                          <xsl:value-of select="orcl:lookup-dvm('Payment Terms','Payment Term Code',imp1:PurchaseOrderHeader/imp1:PaymentTerm/imp1:Term/imp1:ID,'Target',concat(imp1:PurchaseOrderHeader/imp1:PaymentTerm/imp1:Term/imp1:ID,&quot;COMPLIANCE_ERROR&quot;))"/>
                        </imp1:ID>
                      </xsl:when>
                      <xsl:otherwise>
                        <imp1:ID>
                          <xsl:value-of select='imp1:PurchaseOrderHeader/imp1:PaymentTerm/imp1:Term/imp1:ID'/>
                        </imp1:ID>
                      </xsl:otherwise>
                    </xsl:choose>
                    -->
                    <!-- DVM Lookup Updated : 22 Mar -->
                    <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID !='LIEBERTNA'">
                      <!--8 DEC-->
                      <imp1:Description>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:PaymentTerm/imp1:Term/imp1:Description"/>
                      </imp1:Description>
                    </xsl:if>
                    <!--8 DEC-->
                  </imp1:Term>
                </imp1:PaymentTerm>
                <imp1:BuyerParty>
                  <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID !='LIEBERTNA'">
                    <!--8 DEC-->
                    <imp1:PartyIDs>
                      <imp1:ID>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:PartyIDs/imp1:ID"/>
                      </imp1:ID>
                      <imp1:TaxID>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:PartyIDs/imp1:TaxID"/>
                      </imp1:TaxID>
                      <imp1:DUNSID>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:PartyIDs/imp1:DUNSID"/>
                      </imp1:DUNSID>
                    </imp1:PartyIDs>
                  </xsl:if>
                  <!--8 DEC-->
                  <imp1:Name>
                    <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:Name"/>
                  </imp1:Name>
                  <imp1:Location>
                    <imp1:ID>
                      <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:Location/imp1:ID"/>
                    </imp1:ID>
                    <imp1:Address>
                      <imp1:LineOne>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:Location/imp1:Address/imp1:LineOne"/>
                      </imp1:LineOne>
                      <imp1:LineTwo>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:Location/imp1:Address/imp1:LineTwo"/>
                      </imp1:LineTwo>
                      <imp1:LineThree>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:Location/imp1:Address/imp1:LineThree"/>
                      </imp1:LineThree>
                      <imp1:LineFour>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:Location/imp1:Address/imp1:LineFour"/>
                      </imp1:LineFour>
                      <imp1:CityName>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:Location/imp1:Address/imp1:CityName"/>
                      </imp1:CityName>
                      <!-- <imp1:CountrySubDivisionCode>
                    <xsl:value-of select="/inp1:CustomProcessPO/ProcessPO/DataArea/imp1:PurchaseOrder/imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode"/>
                  </imp1:CountrySubDivisionCode> -->
                      <!--LookUp Added -->
                      <!-- DVM Lookup Updated : 22 Mar -->
                      <xsl:if test="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode !=''">
                        <imp1:CountrySubDivisionCode>                          
                          <xsl:value-of select="orcl:lookup-dvm('Country Subdivisions','Country and Subdivision Code',concat(imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:Location/imp1:Address/imp1:CountryCode,'-',imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode),'Target',concat(imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode,&quot;COMPLIANCE_ERROR&quot;))"/>
                          <!--<xsl:value-of select="string('US')"/>-->
                        </imp1:CountrySubDivisionCode>
                      </xsl:if>
                      <xsl:if test="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode =''">
                        <imp1:CountrySubDivisionCode>
                          <!--<xsl:value-of select="orcl:lookup-dvm('Country Subdivisions','Country Subdivision Code',/inp1:CustomProcessPO/ProcessPO/DataArea/imp1:PurchaseOrder/imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode,'Target',concat(/inp1:CustomProcessPO/ProcessPO/DataArea/imp1:PurchaseOrder/imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode,&quot;COMPLIANCE_ERROR&quot;))"/>-->
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode"/>
                        </imp1:CountrySubDivisionCode>
                      </xsl:if>
                      <!-- DVM Lookup Updated : 22 Mar -->
                      <!-- <imp1:CountryCode>
                    <xsl:value-of select="/inp1:CustomProcessPO/ProcessPO/DataArea/imp1:PurchaseOrder/imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:Location/imp1:Address/imp1:CountryCode"/>
                  </imp1:CountryCode> -->
                      <!--LookUp Added -->
                      <xsl:if test="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:Location/imp1:Address/imp1:CountryCode !=''">
                        <imp1:CountryCode>Canada</imp1:CountryCode>
                      </xsl:if>
                      <xsl:if test="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:Location/imp1:Address/imp1:CountryCode =''">
                        <imp1:CountryCode>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:Location/imp1:Address/imp1:CountryCode"/>
                        </imp1:CountryCode>
                      </xsl:if>
                      <imp1:PostalCode>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:Location/imp1:Address/imp1:PostalCode"/>
                      </imp1:PostalCode>
                    </imp1:Address>
                    <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID !='LIEBERTNA'">
                      <!--8 DEC-->
                      <imp1:Description>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:Location/imp1:Description"/>
                      </imp1:Description>
                      <xsl:for-each select="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:Location/imp1:Note">
                        <imp1:Note>
                          <xsl:value-of select="."/>
                        </imp1:Note>
                      </xsl:for-each>
                    </xsl:if>
                    <!--8 DEC-->
                  </imp1:Location>
                  <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID !='LIEBERTNA'">
                    <!--8 DEC-->
                    <imp1:Contact>
                      <imp1:Communication>
                        <imp1:ChannelCode>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:Contact/imp1:Communication[1]/imp1:ChannelCode"/>
                        </imp1:ChannelCode>
                        <imp1:DialNumber>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:Contact/imp1:Communication[1]/imp1:DialNumber"/>
                        </imp1:DialNumber>
                      </imp1:Communication>
                      <imp1:Communication>
                        <imp1:ChannelCode>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:Contact/imp1:Communication[2]/imp1:ChannelCode"/>
                        </imp1:ChannelCode>
                        <imp1:DialNumber>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:Contact/imp1:Communication[2]/imp1:DialNumber"/>
                        </imp1:DialNumber>
                      </imp1:Communication>
                      <imp1:Communication>
                        <imp1:ChannelCode>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:Contact/imp1:Communication[3]/imp1:ChannelCode"/>
                        </imp1:ChannelCode>
                        <imp1:DialNumber>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:Contact/imp1:Communication[3]/imp1:DialNumber"/>
                        </imp1:DialNumber>
                      </imp1:Communication>
                      <imp1:Communication>
                        <imp1:ChannelCode>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:Contact/imp1:Communication[4]/imp1:ChannelCode"/>
                        </imp1:ChannelCode>
                        <imp1:DialNumber>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:Contact/imp1:Communication[4]/imp1:DialNumber"/>
                        </imp1:DialNumber>
                      </imp1:Communication>
                    </imp1:Contact>
                    <imp1:CustomerAccountID>
                      <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:CustomerAccountID"/>
                    </imp1:CustomerAccountID>
                    <imp1:BuyerContact>
                      <imp1:Name>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:BuyerContact/imp1:Name"/>
                      </imp1:Name>
                      <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID !='LIEBERTNA'">
                        <!--8 DEC-->
                        <imp1:JobTitle>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:BuyerContact/imp1:JobTitle"/>
                        </imp1:JobTitle>
                      </xsl:if>
                      <!--8 DEC-->
                      <imp1:Communication>
                        <imp1:ChannelCode>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:BuyerContact/imp1:Communication[1]/imp1:ChannelCode"/>
                        </imp1:ChannelCode>
                        <imp1:URI>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:BuyerContact/imp1:Communication[1]/imp1:URI"/>
                        </imp1:URI>
                      </imp1:Communication>
                      <imp1:Communication>
                        <imp1:ChannelCode>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:BuyerContact/imp1:Communication[2]/imp1:ChannelCode"/>
                        </imp1:ChannelCode>
                        <imp1:DialNumber>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:BuyerContact/imp1:Communication[2]/imp1:DialNumber"/>
                        </imp1:DialNumber>
                      </imp1:Communication>
                      <imp1:Communication>
                        <imp1:ChannelCode>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:BuyerContact/imp1:Communication[3]/imp1:ChannelCode"/>
                        </imp1:ChannelCode>
                        <imp1:DialNumber>
                          <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:BuyerParty/imp1:BuyerContact/imp1:Communication[3]/imp1:DialNumber"/>
                        </imp1:DialNumber>
                      </imp1:Communication>
                    </imp1:BuyerContact>
                  </xsl:if>
                  <!--8 DEC-->
                </imp1:BuyerParty>
                <imp1:ReleaseNumber>
                  <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:ReleaseNumber"/>
                </imp1:ReleaseNumber>
                <imp1:UserArea>
                  <xsl:for-each select="imp1:PurchaseOrderHeader/imp1:UserArea/imp1:Note">
                    <imp1:Note>
                      <xsl:attribute name="author">
                        <xsl:value-of select="@author"/>
                      </xsl:attribute>
                      <xsl:value-of select="."/>
                    </imp1:Note>
                  </xsl:for-each>
                  <xsl:if test="imp1:PurchaseOrderHeader/imp1:UserArea/imp1:CurrencyExchangeRate!=''">
                    <imp1:CurrencyExchangeRate>
                      <imp1:RateNumeric>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:UserArea/imp1:CurrencyExchangeRate/imp1:RateNumeric"/>
                      </imp1:RateNumeric>
                      <imp1:SetDateTime>
                        <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:UserArea/imp1:CurrencyExchangeRate/imp1:SetDateTime"/>
                      </imp1:SetDateTime>
                    </imp1:CurrencyExchangeRate>
                  </xsl:if>
                  <imp1:ActionExpression>
                    <xsl:attribute name="actionCode">
                      <!--<xsl:value-of select="/inp1:CustomProcessPO/ProcessPO/DataArea/imp1:Process/imp1:ActionCriteria/imp1:ActionExpression/@actionCode"/>-->
                      <xsl:value-of select="imp1:PurchaseOrderHeader/imp1:UserArea/imp1:ActionExpression/@actionCode"/>
                    </xsl:attribute>
                  </imp1:ActionExpression>
                </imp1:UserArea>
              </imp1:PurchaseOrderHeader>
              <!--POLINE-->
              <xsl:for-each select="imp1:PurchaseOrderLine">
                <imp1:PurchaseOrderLine>
                  <imp1:LineNumber>
                    <xsl:value-of select="imp1:LineNumber"/>
                  </imp1:LineNumber>
                  <xsl:for-each select="imp1:Note">
                    <imp1:Note>
                      <xsl:value-of select="."/>
                    </imp1:Note>
                  </xsl:for-each>
                  <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID !='LIEBERTNA'">
                    <!--8 DEC-->
                    <imp1:Status>
                      <imp1:Code>
                        <xsl:value-of select="imp1:Status/imp1:Code"/>
                      </imp1:Code>
                    </imp1:Status>
                  </xsl:if>
                  <!--8 DEC-->
                  <imp1:Item>
                    <imp1:ItemID>
                      <imp1:ID>
                        <xsl:value-of select="imp1:Item/imp1:ItemID/imp1:ID"/>
                      </imp1:ID>
                      <imp1:RevisionID>
                        <xsl:value-of select="imp1:Item/imp1:ItemID/imp1:RevisionID"/>
                      </imp1:RevisionID>
                    </imp1:ItemID>
                    <imp1:SupplierItemID>
                      <imp1:ID>
                        <xsl:value-of select="imp1:Item/imp1:SupplierItemID/imp1:ID"/>
                      </imp1:ID>
                      <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID !='LIEBERTNA'">
                        <imp1:RevisionID>
                          <xsl:value-of select="imp1:Item/imp1:SupplierItemID/imp1:RevisionID"/>
                        </imp1:RevisionID>
                      </xsl:if>
                    </imp1:SupplierItemID>
                    <imp1:Description>
                      <xsl:value-of select="imp1:Item/imp1:Description"/>
                    </imp1:Description>
                    <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID !='LIEBERTNA'">
                      <xsl:for-each select="imp1:Item/imp1:Note">
                        <imp1:Note>
                          <xsl:value-of select="."/>
                        </imp1:Note>
                      </xsl:for-each>
                    </xsl:if>
                    <!--Changed the following classification mapppings on 8 dec -->
                    <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID ='LIEBERTNA'">
                      <!--8 DEC-->
                      <imp1:Classification>
                        <imp1:Codes>
                          <xsl:if test="imp1:Item/imp1:Classification/imp1:Codes/imp1:Code[1] !=''">
                            <!--LookUp Added with choose condition on 12 Nov -->
                            <imp1:Code>
                              <xsl:attribute name="name">
                                <xsl:value-of select="string('HTS Code')"/>
                              </xsl:attribute>
                              <xsl:attribute name="sequence">
                                <xsl:value-of select="string('1')"/>
                              </xsl:attribute>
                              <!-- DVM Lookup Updated : 22 Mar -->
                              <!--<xsl:value-of select="orcl:lookup-dvm('DRI Code Values','DRI Code',imp1:Item/imp1:Classification/imp1:Codes/imp1:Code[1],'Target',concat(imp1:Item/imp1:Classification/imp1:Codes/imp1:Code[1],&quot;COMPLIANCE_ERROR&quot;))"/>-->
                              <xsl:value-of select="imp1:Item/imp1:Classification/imp1:Codes/imp1:Code[1]"/>
                              <!-- DVM Lookup Updated : 22 Mar -->
                            </imp1:Code>
                          </xsl:if>
                          <xsl:if test="imp1:Item/imp1:Classification/imp1:Codes/imp1:Code[1] =''">
                            <!--LookUp Added with choose condition on 12 Nov -->
                            <imp1:Code>
                              <xsl:attribute name="name">
                                <xsl:value-of select="string('HTS Code')"/>
                              </xsl:attribute>
                              <xsl:attribute name="sequence">
                                <xsl:value-of select="string('1')"/>
                              </xsl:attribute>
                              <xsl:value-of select="imp1:Item/imp1:Classification/imp1:Codes/imp1:Code[1]"/>
                            </imp1:Code>
                          </xsl:if>
                          <xsl:if test="imp1:Item/imp1:Classification/imp1:Codes/imp1:Code[2] !=''">
                            <imp1:Code>
                              <xsl:attribute name="name">
                                <xsl:value-of select="string('Emerson Commodity Code')"/>
                              </xsl:attribute>
                              <xsl:attribute name="sequence">
                                <xsl:value-of select="string('2')"/>
                              </xsl:attribute>
                              COMPLIANCE_ERROR
                            </imp1:Code>
                          </xsl:if>
                          <xsl:if test="imp1:Item/imp1:Classification/imp1:Codes/imp1:Code[2] =''">
                            <imp1:Code>
                              <xsl:attribute name="name">
                                <xsl:value-of select="string('Emerson Commodity Code')"/>
                              </xsl:attribute>
                              <xsl:attribute name="sequence">
                                <xsl:value-of select="string('2')"/>
                              </xsl:attribute>
                              <xsl:value-of select="imp1:Item/imp1:Classification/imp1:Codes/imp1:Code[2]"/>
                            </imp1:Code>
                          </xsl:if>
                        </imp1:Codes>
                      </imp1:Classification>
                    </xsl:if>
                    <!--8 DEC-->
                    <!--Changed the following Specification mapppings on 8 dec -->
                    <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID ='LIEBERTNA'">
                      <imp1:Specification>
                        <imp1:Property>
                          <xsl:if test='imp1:Item/imp1:Specification/imp1:Property/imp1:NameValue/@unitCode !=""'>
                            <imp1:NameValue>
                              <!--LookUp Added if condition on 12 Nov -->
                              <xsl:attribute name="name">
                                <xsl:value-of select="string('Weight')"/>
                              </xsl:attribute>
                              <!-- DVM Lookup Updated : 22 Mar -->
                              <xsl:choose>
                                  <xsl:when test="imp1:Item/imp1:Specification/imp1:Property/imp1:NameValue/@unitCode = '' ">
                                      <xsl:attribute name="unitCode">
                                        <xsl:value-of select="''"/>
                                      </xsl:attribute>
                                  </xsl:when>
                                  <xsl:otherwise>
                                      <xsl:attribute name="unitCode">
                                        <xsl:value-of select="COMPLIANCE_ERROR"/>
                                      </xsl:attribute>
                                  </xsl:otherwise>
                              </xsl:choose>
                              <xsl:value-of select="imp1:Item/imp1:Specification/imp1:Property/imp1:NameValue"/>
                            </imp1:NameValue>
                          </xsl:if>
                          <!--Added if condition on 12 Nov -->
                          <xsl:if test='imp1:Item/imp1:Specification/imp1:Property/imp1:NameValue/@unitCode =""'>
                            <imp1:NameValue>
                              <!--LookUp Added if condition on 12 Nov -->
                              <xsl:attribute name="name">
                                <xsl:value-of select="string('Weight')"/>
                              </xsl:attribute>
                              <xsl:attribute name="unitCode">
                                <xsl:value-of select="''"/>
                              </xsl:attribute>
                              <xsl:value-of select="imp1:Item/imp1:Specification/imp1:Property/imp1:NameValue"/>
                            </imp1:NameValue>
                          </xsl:if>
                          <!--Added if condition on 12 Nov -->
                        </imp1:Property>
                      </imp1:Specification>
                    </xsl:if>
                    <imp1:HazardousMaterial>
                      <xsl:choose>
                        <xsl:when test="imp1:Item/imp1:HazardousMaterial/imp1:ID !=''">
                          <imp1:ID>
                            <xsl:value-of select="imp1:Item/imp1:HazardousMaterial/imp1:ID"/>
                          </imp1:ID>
                        </xsl:when>
                      </xsl:choose>
                    </imp1:HazardousMaterial>
                  </imp1:Item>
                  <!--  <imp1:Quantity>
                <xsl:attribute name="unitCode">
                  <xsl:value-of select="imp1:Quantity/@unitCode"/>
                </xsl:attribute>
                <xsl:value-of select="imp1:Quantity"/>
              </imp1:Quantity> -->
                  <!--LookUp Added if condition on 12 Nov -->
                  <!-- DVM Lookup Updated : 22 Mar -->
                  <imp1:Quantity>
                    <!--<xsl:if test="imp1:Quantity/@unitCode !=''">-->
                      <xsl:attribute name="unitCode">
                        <xsl:value-of select="COMPLIANCE_ERROR"/>
                      </xsl:attribute>
                      <!--
                    </xsl:if>
                    <xsl:if test="imp1:Quantity/@unitCode =''">
                      <xsl:attribute name="unitCode">
                        <xsl:value-of select="''"/>
                      </xsl:attribute>
                    </xsl:if>
                    -->
                    <xsl:value-of select="imp1:Quantity"/>
                  </imp1:Quantity>
                  <imp1:UnitPrice>
                    <imp1:Amount>
                      <xsl:attribute name="currencyID">
                        <xsl:value-of select="imp1:UnitPrice/imp1:Amount/@currencyID"/>
                      </xsl:attribute>
                      <xsl:value-of select="imp1:UnitPrice/imp1:Amount"/>
                    </imp1:Amount>
                    <imp1:PerQuantity>
                      <xsl:attribute name="unitCode">
                        <xsl:value-of select="imp1:UnitPrice/imp1:PerQuantity/@unitCode"/>
                      </xsl:attribute>
                      <xsl:value-of select="imp1:UnitPrice/imp1:PerQuantity"/>
                    </imp1:PerQuantity>
                  </imp1:UnitPrice>
                  <xsl:for-each select="imp1:PurchaseOrderSubLine">
                    <imp1:PurchaseOrderSubLine>
                      <imp1:LineNumber>
                        <xsl:value-of select="imp1:LineNumber"/>
                      </imp1:LineNumber>
                      <imp1:Description>
                        <xsl:value-of select="imp1:Description"/>
                      </imp1:Description>
                      <imp1:DocumentReference>
                        <imp1:DocumentID>
                          <imp1:ID>
                            <xsl:value-of select="imp1:DocumentReference/imp1:DocumentID/imp1:ID"/>
                          </imp1:ID>
                        </imp1:DocumentID>
                      </imp1:DocumentReference>
                      <imp1:Item>
                        <imp1:ItemID>
                          <imp1:ID>
                            <xsl:value-of select="imp1:Item/imp1:ItemID/imp1:ID"/>
                          </imp1:ID>
                          <imp1:RevisionID>
                            <xsl:value-of select="imp1:Item/imp1:ItemID/imp1:RevisionID"/>
                          </imp1:RevisionID>
                        </imp1:ItemID>
                        <imp1:SupplierItemID>
                          <imp1:ID>
                            <xsl:value-of select="imp1:Item/imp1:SupplierItemID/imp1:ID"/>
                          </imp1:ID>
                          <imp1:RevisionID>
                            <xsl:value-of select="imp1:Item/imp1:SupplierItemID/imp1:RevisionID"/>
                          </imp1:RevisionID>
                        </imp1:SupplierItemID>
                        <imp1:UPCID>
                          <xsl:value-of select="imp1:Item/imp1:UPCID"/>
                        </imp1:UPCID>
                      </imp1:Item>
                      <Quantity>
                        <xsl:attribute name="unitCode">
                          <xsl:value-of select="Quantity/@unitCode"/>
                        </xsl:attribute>
                        <xsl:value-of select="Quantity"/>
                      </Quantity>
                    </imp1:PurchaseOrderSubLine>
                  </xsl:for-each>
                  <xsl:for-each select="imp1:PurchaseOrderSchedule">
                    <imp1:PurchaseOrderSchedule>
                      <imp1:LineNumber>
                        <xsl:value-of select="imp1:LineNumber"/>
                      </imp1:LineNumber>
                      <!--Added as on 8 dec-->
                      <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID !='LIEBERTNA'">
                        <imp1:Description>
                          <xsl:value-of select="imp1:Description"/>
                        </imp1:Description>
                      </xsl:if>
                      <!--Added as on 8 dec-->
                      <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID ='LIEBERTNA'">
                        <imp1:Note>
                          <xsl:attribute name="author">
                            <xsl:value-of select="string('Emerson Location Identifier')"/>
                          </xsl:attribute>
                          <xsl:value-of select="imp1:Note[1]"/>
                        </imp1:Note>
                        <imp1:Note>
                          <xsl:attribute name="author">
                            <xsl:value-of select="string('Kanban Card Number')"/>
                          </xsl:attribute>
                          <xsl:value-of select="imp1:Note[2]"/>
                        </imp1:Note>
                      </xsl:if>
                      <imp1:Quantity>
                      <!-- DVM Lookup Updated : 22 Mar -->
                        <xsl:attribute name="unitCode">
                            <xsl:value-of select="COMPLIANCE_ERROR"/>
                        </xsl:attribute>
                        <!--
                        <xsl:attribute name="unitCode">
                          <xsl:value-of select="imp1:Quantity/@unitCode"/>
                        </xsl:attribute>
                        -->
                        <xsl:value-of select="imp1:Quantity"/>
                      </imp1:Quantity>
                      <imp1:RequiredDeliveryDateTime>
                        <xsl:value-of select="imp1:RequiredDeliveryDateTime"/>
                      </imp1:RequiredDeliveryDateTime>
                      <imp1:UserArea>
                        <xsl:if test="imp1:UserArea/imp1:RequestedShipDateTime !=''">
                          <imp1:RequestedShipDateTime>
                            <xsl:value-of select="imp1:UserArea/imp1:RequestedShipDateTime"/>
                          </imp1:RequestedShipDateTime>
                        </xsl:if>
                           <xsl:if test="imp1:UserArea/imp1:BuyerContact/imp1:Name !=''">
                          <imp1:BuyerContact> <!--Added on 18 MAR-->
                                <imp1:Name>
                                    <xsl:value-of select="imp1:UserArea/imp1:BuyerContact/imp1:Name"/>
                                </imp1:Name>
                                <imp1:JobTitle> 
                                    <xsl:value-of select='imp1:UserArea/imp1:BuyerContact/imp1:JobTitle'/>
                                </imp1:JobTitle>
                          </imp1:BuyerContact>
                          </xsl:if>
                        <imp1:ShipToParty>
                          <imp1:PartyIDs>
                            <imp1:ID>
                              <xsl:value-of select="imp1:UserArea/imp1:ShipToParty/imp1:PartyIDs/imp1:ID"/>
                            </imp1:ID>
                            <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID !='LIEBERTNA'">
                              <imp1:DUNSID>
                                <xsl:value-of select="imp1:UserArea/imp1:ShipToParty/imp1:PartyIDs/imp1:DUNSID"/>
                              </imp1:DUNSID>
                            </xsl:if>
                          </imp1:PartyIDs>
                          <!-- DVM Lookup Updated : 22 Mar -->
                          <xsl:choose> 
                              <xsl:when test="imp1:UserArea/imp1:ShipToParty/imp1:Name = ''">
                                  <imp1:Name>
                                    <xsl:value-of select="string('COMPLIANCE_ERROR')"/>
                                  </imp1:Name>
                              </xsl:when>
                              <xsl:when test="(xp20:compare(imp1:UserArea/imp1:ShipToParty/imp1:Name,xp20:upper-case(imp1:UserArea/imp1:ShipToParty/imp1:Name))) = 0">
                                  <imp1:Name>
                                    <xsl:value-of select="imp1:UserArea/imp1:ShipToParty/imp1:Name"/>
                                  </imp1:Name>
                              </xsl:when>
                              <xsl:otherwise>
                                  <imp1:Name>
                                    <xsl:value-of select="concat(imp1:UserArea/imp1:ShipToParty/imp1:Name,'COMPLIANCE_EXCEPTION')"/>
                                  </imp1:Name>
                              </xsl:otherwise>
                          </xsl:choose>
                          <!--
                          <xsl:for-each select="imp1:UserArea/imp1:ShipToParty/imp1:Name">
                            <imp1:Name>
                              <xsl:value-of select="."/>
                            </imp1:Name>
                          </xsl:for-each>
                          -->
                          <!-- DVM Lookup Updated : 22 Mar -->
                          <imp1:Location>
                            <imp1:ID>
                              <xsl:value-of select="imp1:UserArea/imp1:ShipToParty/imp1:Location/imp1:ID"/>
                            </imp1:ID>
                            <imp1:Address>
                              <imp1:LineOne>
                                <xsl:value-of select="imp1:UserArea/imp1:ShipToParty/imp1:Location/imp1:Address/imp1:LineOne"/>
                              </imp1:LineOne>
                              <imp1:LineTwo>
                                <xsl:value-of select="imp1:UserArea/imp1:ShipToParty/imp1:Location/imp1:Address/imp1:LineTwo"/>
                              </imp1:LineTwo>
                              <imp1:LineThree>
                                <xsl:value-of select="imp1:UserArea/imp1:ShipToParty/imp1:Location/imp1:Address/imp1:LineThree"/>
                              </imp1:LineThree>
                              <imp1:LineFour>
                                <xsl:value-of select="imp1:UserArea/imp1:ShipToParty/imp1:Location/imp1:Address/imp1:LineFour"/>
                              </imp1:LineFour>
                              <imp1:CityName>
                                <xsl:value-of select="imp1:UserArea/imp1:ShipToParty/imp1:Location/imp1:Address/imp1:CityName"/>
                              </imp1:CityName>
                              <!--LookUp Added -->
                              <!--<imp1:CountrySubDivisionCode>
                            <xsl:value-of select="orcl:lookup-dvm('Country Subdivisions','Country Subdivision Code',imp1:UserArea/imp1:ShipToParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode,'Target',concat(imp1:UserArea/imp1:ShipToParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode,&quot;COMPLIANCE_ERROR&quot;))"/>
                          </imp1:CountrySubDivisionCode> -->
                              <!--LookUp Added with choose condition on 12 Nov -->
                              <!-- Updated : 17 Apr -->
                              <!-- DVM Lookup Updated : 22 Mar -->
                              <!--
                              <imp1:CountrySubDivisionCode>                            
                                <xsl:value-of select="orcl:lookup-dvm('Country Subdivisions','Country and Subdivision Code',concat(imp1:UserArea/imp1:ShipToParty/imp1:Location/imp1:Address/imp1:CountryCode,'-',imp1:UserArea/imp1:ShipToParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode),'Target',concat(imp1:UserArea/imp1:ShipToParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode,&quot;COMPLIANCE_ERROR&quot;))"/>
                              </imp1:CountrySubDivisionCode>
                              -->
                              <xsl:choose>
                                <xsl:when test='imp1:UserArea/imp1:ShipToParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode !=""'>
                                  <imp1:CountrySubDivisionCode>                                    
                                    <!--<xsl:value-of select="orcl:lookup-dvm('Country Subdivisions','Subdivision Code',imp1:UserArea/imp1:ShipToParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode,'Target',concat(imp1:UserArea/imp1:ShipToParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode,&quot;COMPLIANCE_ERROR&quot;))"/>-->
                                    <xsl:value-of select="orcl:lookup-dvm('Country Subdivisions','Country and Subdivision Code',concat(imp1:UserArea/imp1:ShipToParty/imp1:Location/imp1:Address/imp1:CountryCode,'-',imp1:UserArea/imp1:ShipToParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode),'Target',concat(imp1:UserArea/imp1:ShipToParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode,&quot;COMPLIANCE_ERROR&quot;))"/>
                                    <!--<xsl:value-of select="string('US')"/>-->
                                  </imp1:CountrySubDivisionCode>
                                </xsl:when>
                                <xsl:otherwise>
                                  <imp1:CountrySubDivisionCode>
                                    <xsl:value-of select='imp1:UserArea/imp1:ShipToParty/imp1:Location/imp1:Address/imp1:CountrySubDivisionCode'/>
                                  </imp1:CountrySubDivisionCode>
                                </xsl:otherwise>
                              </xsl:choose>
                              <!-- DVM Lookup Updated : 22 Mar -->
                              <!-- Updated : 17 Apr -->
                              <!--LookUp Added -->
                              <!--<imp1:CountryCode>
                             <xsl:value-of select="orcl:lookup-dvm('Countries','Country Code',imp1:UserArea/imp1:ShipToParty/imp1:Location/imp1:Address/imp1:CountryCode,'Target',concat(imp1:UserArea/imp1:ShipToParty/imp1:Location/imp1:Address/imp1:CountryCode,&quot;COMPLIANCE_ERROR&quot;))"/>
                          </imp1:CountryCode> -->
                              <!--LookUp Added with choose condition on 12 Nov -->
                              <!-- DVM Lookup Updated : 22 Mar -->
                              <imp1:CountryCode>Canada</imp1:CountryCode>
                              <!--
                              <xsl:choose>
                                <xsl:when test='imp1:UserArea/imp1:ShipToParty/imp1:Location/imp1:Address/imp1:CountryCode !=""'>
                                  <imp1:CountryCode>
                                    <xsl:value-of select="orcl:lookup-dvm('Countries','Country Code',imp1:UserArea/imp1:ShipToParty/imp1:Location/imp1:Address/imp1:CountryCode,'Target',concat(imp1:UserArea/imp1:ShipToParty/imp1:Location/imp1:Address/imp1:CountryCode,&quot;COMPLIANCE_ERROR&quot;))"/>
                                  </imp1:CountryCode>
                                </xsl:when>
                                <xsl:otherwise>
                                  <imp1:CountryCode>
                                    <xsl:value-of select='""'/>
                                  </imp1:CountryCode>
                                </xsl:otherwise>
                              </xsl:choose>
                              -->
                              <!-- DVM Lookup Updated : 22 Mar -->
                              <imp1:PostalCode>
                                <xsl:value-of select="imp1:UserArea/imp1:ShipToParty/imp1:Location/imp1:Address/imp1:PostalCode"/>
                              </imp1:PostalCode>
                            </imp1:Address>
                            <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID !='LIEBERTNA'">
                              <imp1:Description>
                                <xsl:value-of select="imp1:UserArea/imp1:ShipToParty/imp1:Location/imp1:Description"/>
                              </imp1:Description>
                            </xsl:if>
                            <xsl:for-each select="imp1:UserArea/imp1:ShipToParty/imp1:Location/imp1:Note">
                              <imp1:Note>
                                <xsl:value-of select="."/>
                              </imp1:Note>
                            </xsl:for-each>
                          </imp1:Location>
                          <xsl:if test='imp1:UserArea/imp1:ShipToParty/imp1:Contact[1]/@type = "Contact1"'>
                            <imp1:Contact>
                              <xsl:attribute name="type">
                                <xsl:value-of select="imp1:UserArea/imp1:ShipToParty/imp1:Contact/@type"/>
                              </xsl:attribute>
                              <imp1:Name>
                                <xsl:value-of select="imp1:UserArea/imp1:ShipToParty/imp1:Contact/imp1:Name"/>
                              </imp1:Name>
                              <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID !='LIEBERTNA'">
                                <!--8 DEC-->
                                <imp1:JobTitle>
                                  <xsl:value-of select="imp1:UserArea/imp1:ShipToParty/imp1:Contact/imp1:JobTitle"/>
                                </imp1:JobTitle>
                              </xsl:if>
                              <!--8 DEC-->
                              <imp1:Communication>
                                <imp1:ChannelCode>
                                  <xsl:value-of select="imp1:UserArea/imp1:ShipToParty/imp1:Contact/imp1:Communication[1]/imp1:ChannelCode"/>
                                </imp1:ChannelCode>
                                <imp1:URI>
                                  <xsl:value-of select="imp1:UserArea/imp1:ShipToParty/imp1:Contact/imp1:Communication[1]/imp1:URI"/>
                                </imp1:URI>
                              </imp1:Communication>
                              <imp1:Communication>
                                <imp1:ChannelCode>
                                  <xsl:value-of select="imp1:UserArea/imp1:ShipToParty/imp1:Contact/imp1:Communication[2]/imp1:ChannelCode"/>
                                </imp1:ChannelCode>
                                <imp1:DialNumber>
                                  <xsl:value-of select="imp1:UserArea/imp1:ShipToParty/imp1:Contact/imp1:Communication[2]/imp1:DialNumber"/>
                                </imp1:DialNumber>
                              </imp1:Communication>
                              <imp1:Communication>
                                <imp1:ChannelCode>
                                  <xsl:value-of select="imp1:UserArea/imp1:ShipToParty/imp1:Contact/imp1:Communication[3]/imp1:ChannelCode"/>
                                </imp1:ChannelCode>
                                <imp1:DialNumber>
                                  <xsl:value-of select="imp1:UserArea/imp1:ShipToParty/imp1:Contact/imp1:Communication[3]/imp1:DialNumber"/>
                                </imp1:DialNumber>
                              </imp1:Communication>
                            </imp1:Contact>
                          </xsl:if>
                          <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID !='LIEBERTNA'">
                            <!--8 DEC-->
                            <xsl:if test='imp1:UserArea/imp1:ShipToParty/imp1:Contact[2]/@type = "Contact2"'>
                              <imp1:Contact>
                                <xsl:attribute name="type">
                                  <xsl:value-of select="imp1:UserArea/imp1:ShipToParty/imp1:Contact[2]/@type"/>
                                </xsl:attribute>
                                <imp1:Communication>
                                  <imp1:ChannelCode>
                                    <xsl:value-of select="imp1:UserArea/imp1:ShipToParty/imp1:Contact[2]/imp1:Communication[1]/imp1:ChannelCode"/>
                                  </imp1:ChannelCode>
                                  <imp1:DialNumber>
                                    <xsl:value-of select="imp1:UserArea/imp1:ShipToParty/imp1:Contact[2]/imp1:Communication[1]/imp1:DialNumber"/>
                                  </imp1:DialNumber>
                                </imp1:Communication>
                                <imp1:Communication>
                                  <imp1:ChannelCode>
                                    <xsl:value-of select="imp1:UserArea/imp1:ShipToParty/imp1:Contact[2]/imp1:Communication[2]/imp1:ChannelCode"/>
                                  </imp1:ChannelCode>
                                  <imp1:DialNumber>
                                    <xsl:value-of select="imp1:UserArea/imp1:ShipToParty/imp1:Contact[2]/imp1:Communication[2]/imp1:DialNumber"/>
                                  </imp1:DialNumber>
                                </imp1:Communication>
                                <imp1:Communication>
                                  <imp1:ChannelCode>
                                    <xsl:value-of select="imp1:UserArea/imp1:ShipToParty/imp1:Contact[2]/imp1:Communication[3]/imp1:ChannelCode"/>
                                  </imp1:ChannelCode>
                                  <imp1:DialNumber>
                                    <xsl:value-of select="imp1:UserArea/imp1:ShipToParty/imp1:Contact[2]/imp1:Communication[3]/imp1:DialNumber"/>
                                  </imp1:DialNumber>
                                </imp1:Communication>
                                <imp1:Communication>
                                  <imp1:ChannelCode>
                                    <xsl:value-of select="imp1:UserArea/imp1:ShipToParty/imp1:Contact[2]/imp1:Communication[4]/imp1:ChannelCode"/>
                                  </imp1:ChannelCode>
                                  <imp1:DialNumber>
                                    <xsl:value-of select="imp1:UserArea/imp1:ShipToParty/imp1:Contact[2]/imp1:Communication[4]/imp1:DialNumber"/>
                                  </imp1:DialNumber>
                                </imp1:Communication>
                              </imp1:Contact>
                            </xsl:if>
                          </xsl:if>
                          <!--8 DEC-->
                        </imp1:ShipToParty>
                      </imp1:UserArea>
                    </imp1:PurchaseOrderSchedule>
                  </xsl:for-each>
                  <xsl:if test="/inp1:CustomProcessPO/ProcessPO/imp1:ApplicationArea/imp1:Sender/imp1:LogicalID !='LIEBERTNA'">
                    <imp1:UserArea>
                      <xsl:for-each select="imp1:UserArea/imp1:Note">
                        <imp1:Note>
                          <xsl:attribute name="author">
                            <xsl:value-of select="@author"/>
                          </xsl:attribute>
                          <xsl:value-of select="."/>
                        </imp1:Note>
                      </xsl:for-each>
                    </imp1:UserArea>
                  </xsl:if>
                </imp1:PurchaseOrderLine>
              </xsl:for-each>
            </imp1:PurchaseOrder>
          </xsl:for-each>
          <!--8 DEC-->
        </DataArea>
      </ProcessPO>
      <Message_id>
        <xsl:value-of select="/inp1:CustomProcessPO/Message_id"/>
      </Message_id>
      <Message_direction>
        <xsl:value-of select="/inp1:CustomProcessPO/Message_direction"/>
      </Message_direction>
      <Sender_Document_number>
        <xsl:value-of select="/inp1:CustomProcessPO/Sender_Document_number"/>
      </Sender_Document_number>
      <Sender_Message_type>
        <xsl:value-of select="/inp1:CustomProcessPO/Sender_Message_type"/>
      </Sender_Message_type>
      <Sender_Message_standard>
        <xsl:value-of select="/inp1:CustomProcessPO/Sender_Message_standard"/>
      </Sender_Message_standard>
      <Sender_Transaction_type>
        <xsl:value-of select="/inp1:CustomProcessPO/Sender_Transaction_type"/>
      </Sender_Transaction_type>
      <Sender_Transaction_subtype>
        <xsl:value-of select="/inp1:CustomProcessPO/Sender_Transaction_subtype"/>
      </Sender_Transaction_subtype>
      <Sender_System_type>
        <xsl:value-of select="/inp1:CustomProcessPO/Sender_System_type"/>
      </Sender_System_type>
      <Sender_Id>
        <xsl:value-of select="/inp1:CustomProcessPO/Sender_Id"/>
      </Sender_Id>
      <Sender_Site_Id>
        <xsl:value-of select="/inp1:CustomProcessPO/Sender_Site_Id"/>
      </Sender_Site_Id>
      <Sender_Name>
        <xsl:value-of select="/inp1:CustomProcessPO/Sender_Name"/>
      </Sender_Name>
      <Sender_Type>
        <xsl:value-of select="/inp1:CustomProcessPO/Sender_Type"/>
      </Sender_Type>
      <Receiver_System_type>
        <xsl:value-of select="/inp1:CustomProcessPO/Receiver_System_type"/>
      </Receiver_System_type>
      <Receiver_Id>
        <xsl:value-of select="/inp1:CustomProcessPO/ProcessPO/DataArea/imp1:PurchaseOrder/imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:PartyIDs/imp1:ID"/>
      </Receiver_Id>
      <Receiver_Site_id>
        <xsl:value-of select="/inp1:CustomProcessPO/ProcessPO/DataArea/imp1:PurchaseOrder/imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Location/imp1:ID"/>
      </Receiver_Site_id>
      <Receiver_Name>
        <xsl:value-of select="/inp1:CustomProcessPO/ProcessPO/DataArea/imp1:PurchaseOrder/imp1:PurchaseOrderHeader/imp1:SupplierParty/imp1:Name"/>
      </Receiver_Name>
      <Receiver_type>
        <xsl:value-of select="/inp1:CustomProcessPO/Receiver_type"/>
      </Receiver_type>
      <File_name>
        <xsl:value-of select="/inp1:CustomProcessPO/File_name"/>
      </File_name>
      <Record_total>
        <xsl:value-of select="/inp1:CustomProcessPO/Record_total"/>
      </Record_total>
      <Record_number>
        <xsl:value-of select="/inp1:CustomProcessPO/Record_number"/>
      </Record_number>
      <Flow_id_1>
        <xsl:value-of select="/inp1:CustomProcessPO/Flow_id_1"/>
      </Flow_id_1>
      <Flow_id_2>
        <xsl:value-of select="/inp1:CustomProcessPO/Flow_id_2"/>
      </Flow_id_2>
      <Flow_id_3>
        <xsl:value-of select="/inp1:CustomProcessPO/Flow_id_3"/>
      </Flow_id_3>
      <Send_on_fail>
        <xsl:value-of select="/inp1:CustomProcessPO/Send_on_fail"/>
      </Send_on_fail>
      <Division_name>
        <xsl:value-of select="/inp1:CustomProcessPO/Division_name"/>
      </Division_name>
      <Division_format>
        <xsl:value-of select="/inp1:CustomProcessPO/Division_format"/>
      </Division_format>
      <Trading_partner_1_name>
        <xsl:value-of select="/inp1:CustomProcessPO/Trading_partner_1_name"/>
      </Trading_partner_1_name>
      <Trading_partner_1_format>
        <xsl:value-of select="/inp1:CustomProcessPO/Trading_partner_1_format"/>
      </Trading_partner_1_format>
      <Trading_partner_1_date_from>
        <xsl:value-of select="/inp1:CustomProcessPO/Trading_partner_1_date_from"/>
      </Trading_partner_1_date_from>
      <Trading_partner_1_date_to>
        <xsl:value-of select="/inp1:CustomProcessPO/Trading_partner_1_date_to"/>
      </Trading_partner_1_date_to>
      <Trading_partner_2_name>
        <xsl:value-of select="/inp1:CustomProcessPO/Trading_partner_2_name"/>
      </Trading_partner_2_name>
      <Trading_partner_2_format>
        <xsl:value-of select="/inp1:CustomProcessPO/Trading_partner_2_format"/>
      </Trading_partner_2_format>
      <Trading_partner_2_date_from>
        <xsl:value-of select="/inp1:CustomProcessPO/Trading_partner_2_date_from"/>
      </Trading_partner_2_date_from>
      <Trading_partner_2_date_to>
        <xsl:value-of select="/inp1:CustomProcessPO/Trading_partner_2_date_to"/>
      </Trading_partner_2_date_to>
      <Trading_partner_3_name>
        <xsl:value-of select="/inp1:CustomProcessPO/Trading_partner_3_name"/>
      </Trading_partner_3_name>
      <Trading_partner_3_format>
        <xsl:value-of select="/inp1:CustomProcessPO/Trading_partner_3_format"/>
      </Trading_partner_3_format>
      <Trading_partner_3_date_from>
        <xsl:value-of select="/inp1:CustomProcessPO/Trading_partner_3_date_from"/>
      </Trading_partner_3_date_from>
      <Trading_partner_3_date_to>
        <xsl:value-of select="/inp1:CustomProcessPO/Trading_partner_3_date_to"/>
      </Trading_partner_3_date_to>
      <Logistics_1_name>
        <xsl:value-of select="/inp1:CustomProcessPO/Logistics_1_name"/>
      </Logistics_1_name>
      <Logistics_1_format>
        <xsl:value-of select="/inp1:CustomProcessPO/Logistics_1_format"/>
      </Logistics_1_format>
      <Logistics_1_date_from>
        <xsl:value-of select="/inp1:CustomProcessPO/Logistics_1_date_from"/>
      </Logistics_1_date_from>
      <Logistics_1_date_to>
        <xsl:value-of select="/inp1:CustomProcessPO/Logistics_1_date_to"/>
      </Logistics_1_date_to>
      <Logistics_2_name>
        <xsl:value-of select="/inp1:CustomProcessPO/Logistics_2_name"/>
      </Logistics_2_name>
      <Logistics_2_format>
        <xsl:value-of select="/inp1:CustomProcessPO/Logistics_2_format"/>
      </Logistics_2_format>
      <Logistics_2_date_from>
        <xsl:value-of select="/inp1:CustomProcessPO/Logistics_2_date_from"/>
      </Logistics_2_date_from>
      <Logistics_2_date_to>
        <xsl:value-of select="/inp1:CustomProcessPO/Logistics_2_date_to"/>
      </Logistics_2_date_to>
      <Logistics_3_name>
        <xsl:value-of select="/inp1:CustomProcessPO/Logistics_3_name"/>
      </Logistics_3_name>
      <Logistics_3_format>
        <xsl:value-of select="/inp1:CustomProcessPO/Logistics_3_format"/>
      </Logistics_3_format>
      <Logistics_3_date_from>
        <xsl:value-of select="/inp1:CustomProcessPO/Logistics_3_date_from"/>
      </Logistics_3_date_from>
      <Logistics_3_date_to>
        <xsl:value-of select="/inp1:CustomProcessPO/Logistics_3_date_to"/>
      </Logistics_3_date_to>
      <Compliance_result>
        <xsl:value-of select="/inp1:CustomProcessPO/Compliance_result"/>
      </Compliance_result>
      <!--
      <xsl:if test="/inp1:CustomProcessPO/ProcessPO/DataArea/imp1:PurchaseOrder/imp1:PurchaseOrderLine/imp1:PurchaseOrderSchedule/imp1:UserArea/imp1:ShipToParty/imp1:Location/imp1:ID =''">
        <xsl:variable name="ShipToLocationID">
            <xsl:value-of select="string('NA')"/>
        </xsl:variable>
        </xsl:if>
        <xsl:if test="/inp1:CustomProcessPO/ProcessPO/DataArea/imp1:PurchaseOrder/imp1:PurchaseOrderLine/imp1:PurchaseOrderSchedule/imp1:UserArea/imp1:ShipToParty/imp1:Location/imp1:ID !=''">
        <xsl:variable name="ShipToLocationID">
            <xsl:value-of select="/inp1:CustomProcessPO/ProcessPO/DataArea/imp1:PurchaseOrder/imp1:PurchaseOrderLine/imp1:PurchaseOrderSchedule/imp1:UserArea/imp1:ShipToParty/imp1:Location/imp1:ID"/>
        </xsl:variable>
        </xsl:if>
      <Attribute1>
        <xsl:value-of select="$ShipToLocationID"/>
      </Attribute1>
      -->
      <xsl:if test="/inp1:CustomProcessPO/ProcessPO/DataArea/imp1:PurchaseOrder/imp1:PurchaseOrderLine/imp1:PurchaseOrderSchedule/imp1:UserArea/imp1:ShipToParty/imp1:Location/imp1:ID =''">
        <Attribute1>
        <xsl:value-of select="string('NA')"/>
      </Attribute1>
        </xsl:if>
<xsl:if test="/inp1:CustomProcessPO/ProcessPO/DataArea/imp1:PurchaseOrder/imp1:PurchaseOrderLine/imp1:PurchaseOrderSchedule/imp1:UserArea/imp1:ShipToParty/imp1:Location/imp1:ID != ''">
        <Attribute1>
        <xsl:value-of select="/inp1:CustomProcessPO/ProcessPO/DataArea/imp1:PurchaseOrder/imp1:PurchaseOrderLine/imp1:PurchaseOrderSchedule/imp1:UserArea/imp1:ShipToParty/imp1:Location/imp1:ID"/>
      </Attribute1>
        </xsl:if>
      <Attribute2>
        <xsl:value-of select="/inp1:CustomProcessPO/Attribute2"/>
      </Attribute2>
      <Attribute3>
        <xsl:value-of select="/inp1:CustomProcessPO/Attribute3"/>
      </Attribute3>
      <Attribute4>
        <xsl:value-of select="/inp1:CustomProcessPO/Attribute4"/>
      </Attribute4>
      <Attribute5>
        <xsl:value-of select="/inp1:CustomProcessPO/Attribute5"/>
      </Attribute5>
      <Attribute6>
        <xsl:value-of select="/inp1:CustomProcessPO/Attribute6"/>
      </Attribute6>
      <Attribute7>
        <xsl:value-of select="/inp1:CustomProcessPO/Attribute7"/>
      </Attribute7>
      <Attribute8>
        <xsl:value-of select="/inp1:CustomProcessPO/Attribute8"/>
      </Attribute8>
      <Attribute9>
        <xsl:value-of select="/inp1:CustomProcessPO/Attribute9"/>
      </Attribute9>
      <Attribute10>
        <xsl:value-of select="/inp1:CustomProcessPO/Attribute10"/>
      </Attribute10>
    </inp1:CustomProcessPO>
  </xsl:template>
</xsl:stylesheet>
